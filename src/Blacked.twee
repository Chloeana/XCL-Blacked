:: blacked compatibility [initialize init_new]
{
  (set:$blacked_mod_installed to true)

  (set:$blacked_compatible_list to (dm:
    "alina",1,
    "cassidy",0,
    "ella",1,
    "jade",1,
    "jia",1,
    "lana",1,
    "liya",1,
    "mia",1,
    "rae",1,
    "scarlit",1
    ))

  (if:(checkdm:$blacked_compatible_list, $character's "id","is",1))[(set:$blacked_compatible to 1)]
  (else:)[(set:$blacked_compatible to 0)]

  (if:$blacked_stats is 0)[
    (set:$blacked_stats to (dm:
    "sex as guy",0,
    "sex as girl",0,
    "anal sex as girl",0,
    "creampies given",0,
    "creampies received",0,
    "blowjobs given",0,
    "blowjobs received",0,
    "facials given",0,
    "facials received",0,
    "came in mouth",0,
    "loads swallowed",0,
    "came on tits",0,
    "came on body",0,
    "cunnilingus given as guy",0,
    "cunnilingus given as girl",0,
    "cunnilingus received",0,
    "guys fully satisfied",0,
    "times fertilized",0,
    "bbc porn watched",0,
    "rejections",0,
    "big cocks",0
    ))
  ]

  (if:$blacked_daily_stats is 0)[
    (set:$blacked_daily_stats to (dm:
    "sex as guy",0,
    "sex as girl",0,
    "anal sex as girl",0,
    "creampies given",0,
    "creampies received",0,
    "breeder creampies",0,
    "blowjobs given",0,
    "blowjobs received",0,
    "facials given",0,
    "facials received",0,
    "came in mouth",0,
    "loads swallowed",0,
    "came on tits",0,
    "came on body",0,
    "cunnilingus given as guy",0,
    "cunnilingus given as girl",0,
    "cunnilingus received",0,
    "guys fully satisfied",0,
    "bbc porn watched",0,
    "orgasms",0,
    "rejections",0,
    "beach sex",0
    ))
  ]

  (if:$blacked_events is 0)[(set:$blacked_events to (a:))]
}

:: blacked compatibility check
{
  (if:$blackfreq is "Black Encounters: Never")[(set:$blacked_compatible to 0)]
  (else-if:(checkdm:$blacked_compatible_list, ($character's id),"is",1))[
    (set:$blacked_compatible to 1)]
  (else:)[(set:$blacked_compatible to 0)]
}

:: blacked font [header]
{
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        .blacked-font {
        font-family: 'Montserrat', sans-serif;
        font-weight: bold;
        }
    </style>
}

:: blacked options [mod_options]
{
  (css:"font-family: 'Montserrat', sans-serif; font-weight: bold; color: white; background-color: black; padding: 2px;")[BLACKED] Settings:(nl:1)
	(_setting_button:
		"$blackfreq",(a:
      "Black Encounters: Normal",
      "Black Encounters: Less",
      "Black Encounters: More",
      "Black Encounters: Always",
      "Black Encounters: Never"
    ), "Determines how often you will encounter random black men hitting on you as a female."
	)
}

:: view sex stats [around]
(display:_around)<div class='options'>(link:"Blacked Sex Stats")[(set:$next to "blacked sex stats")(display:"change screen")]</div>

:: blacked sex stats
(display:"Game Version")<div class='options'>(color:$palette_colors's 4th)[(css:"font-size:5vmin")[<span class='shadow'>Sex Stats (BLACKED)</span>]]</div>
<span class='shadow'>(color:"bisque")[As a Black guy...]
Times had sex: (print:$blacked_stats's "sex as guy")
Blowjobs received: (print:$blacked_stats's "blowjobs received")
Cunnilingus given: (print:$blacked_stats's "cunnilingus given as guy")
Creampies given: (print:$blacked_stats's "creampies given")
Facials given: (print:$blacked_stats's "facials given")
Finished in Mouth: (print:$blacked_stats's "came in mouth")
Finished on Body: (print:$blacked_stats's "came on body")
Finished on Tits: (print:$blacked_stats's "came on tits")

(color:"bisque")[As a girl (from/to a Black guy)...]
Vaginal sex: (print:$blacked_stats's "sex as girl")
Anal sex: (print:$blacked_stats's "anal sex as girl")
Blowjobs given: (print:$blacked_stats's "blowjobs given")
Cunnilingus received: (print:$blacked_stats's "cunnilingus received")
Creampies received: (print:$blacked_stats's "creampies received")
Facials received: (print:$blacked_stats's "facials received")
Loads swallowed: (print:$blacked_stats's "loads swallowed")
Huge cocks inserted: (print:$blacked_stats's "big cocks")
</span>

<div class='options'>(if:$blacked_stats's "sex as girl" is 0 and $blacked_stats's "sex as guy" is 0 and $blacked_stats's "blowjobs given" is 0 and $blacked_stats's "blowjobs received" is 0)[(twirl:"No judgment!","It's ok!","Aw, don't worry about it.","That's totally fine!","This is a judgment-free zone!") (twirl:"Whenever you're ready.","We're on your schedule.","Take your time.","I'm just giving you the stats.","Think of those zeroes like possibilities.")
](link:"Back")[(set:$next to "view sex stats")(display:"change screen")]</div>

:: blacked tips [tipjar]
{
  (set:_tips to it + (a:
    "If you're looking for some extra cash at night, talk to Dredd at The Broken Drum.",
    "You may have heard the term 'Size Queen'. It tends to go hand-in-hand with BBC lovers.",
    "You may have heard the term 'Nympho'. It's not just a fetish. Some people *need* to have sex multiple times a day.",
    "Breeders can be dangerous... but they can also be fun. Like, several times a day fun..."
  ))
}

:: blacked init voice lines [initialize init_new]
{
  (newtrack:"aubrey bbc addiction","aud/se/npc/blacked/aubrey/voice lines/bbc addiction.mp3")
  (newtrack:"aubrey careful","aud/se/npc/blacked/aubrey/voice lines/careful.mp3")
  (newtrack:"aubrey clear throat","aud/se/npc/blacked/aubrey/voice lines/clear throat.mp3")
  (newtrack:"aubrey craving","aud/se/npc/blacked/aubrey/voice lines/craving.mp3")
  (newtrack:"aubrey disrobe","aud/se/npc/blacked/aubrey/voice lines/disrobe.mp3")
  (newtrack:"aubrey excuse me","aud/se/npc/blacked/aubrey/voice lines/excuse me.mp3")
  (newtrack:"aubrey have a look","aud/se/npc/blacked/aubrey/voice lines/have a look.mp3")
  (newtrack:"aubrey have a seat","aud/se/npc/blacked/aubrey/voice lines/have a seat.mp3")
  (newtrack:"aubrey next time","aud/se/npc/blacked/aubrey/voice lines/next time.mp3")
  (newtrack:"aubrey not bad","aud/se/npc/blacked/aubrey/voice lines/not bad.mp3")
  (newtrack:"aubrey of course","aud/se/npc/blacked/aubrey/voice lines/of course.mp3")
  (newtrack:"aubrey rabbit hole","aud/se/npc/blacked/aubrey/voice lines/rabbit hole.mp3")
  (newtrack:"aubrey serious","aud/se/npc/blacked/aubrey/voice lines/serious.mp3")
  (newtrack:"aubrey still quit","aud/se/npc/blacked/aubrey/voice lines/still quit.mp3")
  (newtrack:"aubrey turn up","aud/se/npc/blacked/aubrey/voice lines/turn up.mp3")
  (newtrack:"aubrey what","aud/se/npc/blacked/aubrey/voice lines/what.mp3")
  (newtrack:"aubrey you do","aud/se/npc/blacked/aubrey/voice lines/you do.mp3")
  (newtrack:"isabelle dream intro","aud/se/npc/blacked/isabelle/voice lines/dream intro.mp3")
  (newtrack:"isabelle left out","aud/se/npc/blacked/isabelle/voice lines/left out.mp3")
  (newtrack:"isabelle orgasm","aud/se/npc/blacked/isabelle/orgasm/orgasm.mp3")
  (newtrack:"kendra dominated","aud/se/npc/blacked/kendra/voice lines/dominated.mp3")
  (newtrack:"kendra go down","aud/se/npc/blacked/kendra/voice lines/go down.mp3")
  (newtrack:"kendra grab ass","aud/se/npc/blacked/kendra/voice lines/grab ass.mp3")
  (newtrack:"kendra hot","aud/se/npc/blacked/kendra/voice lines/hot.mp3")
  (newtrack:"kendra loving it","aud/se/npc/blacked/kendra/voice lines/loving it.mp3")
  (newtrack:"kendra watching","aud/se/npc/blacked/kendra/voice lines/watching.mp3")
  (newtrack:"kendra take a look","aud/se/npc/blacked/kendra/take a look.mp3")
  (newtrack:"kendra clean up nice","aud/se/npc/blacked/kendra/clean up nice.mp3")
  (newtrack:"kendra surprised","aud/se/npc/blacked/kendra/surprised.mp3")
}

:: blacked init npcs [initialize init_new]
{
  (set:$kendra to $npcs's kendra's name)
  (set:$gabbie to $npcs's gabbie's name)

  (if:$black_coworkers is 0)(set:$black_coworkers to (a:))
  (if:$blacked_npcs is 0)[(set:$blacked_npcs to (dm:))]
  (if:$blacked_npcs_men is 0)[(set:$blacked_npcs_men to (dm:))]

  (if:(datanames:$blacked_npcs) does not contain "aubreyblack")[
    (set:$blacked_npcs to it + (dm:"aubreyblack", (dm:
      "id", "aubreyblack",
      "name", "Aubrey",
      "unfamiliar name",(twirl:"Blonde MILF", "Older Blonde Babe", "Hot Blonde Mom"),
      "race", "white",
      "breasts", "E",
      "bra", "36E",
      "eyes","hazel",
      "butt", "bubble",
      "hair", "blonde",
      "body type","voluptuous",
      "familiarity male", 0,
      "familiarity female", 0,
      "likes", (a:"wine","cowgirl","rough sex"),
      "dislikes", (a:"beer"),
      "traits", (a:"likes assertive","rich","slut","pill","size queen"),
      "events", (a:),
      "topics", (a:),
      "sex positions", (a:),
      "voice line prefix", "aud/se/npc/blacked/aubrey/voice lines/",
      "img", "img/npc/girls/blacked/aubrey/portrait_normal.jpg",
      "img dir", "img/npc/girls/blacked/aubrey/portrait_"
    )))

    (set:$relationships's aubreyblack to (dm:
      "id","aubreyblack",
      "name","Aubrey",
      "gender","female",
      "respect",0,
      "dom",2,
      "friendship",0,
      "attraction",0,
      "tags",(a:),
      "events",(a:)
    ))
  ]

  (if:(datanames:$blacked_npcs) does not contain "isabelledeltore")[
    (set:$blacked_npcs to it + (dm:"isabelledeltore", (dm:
      "id", "isabelledeltore",
      "name", "Isabelle",
      "unfamiliar name",(twirl:"Busty Blonde", "Slutty Looking Blonde", "Blonde Bombshell"),
      "race", "white",
      "breasts", "E",
      "bra", "32E",
      "eyes","blue",
      "butt", "bubble",
      "hair", "blonde",
      "body type","average",
      "familiarity male", 0,
      "familiarity female", 0,
      "likes", (a:"black","fruity cocktail","doggystyle","rough sex"),
      "dislikes", (a:"beer"),
      "traits", (a:"likes assertive","bimbo","pill","only bbc"),
      "events", (a:),
      "topics", (a:),
      "sex positions", (a:),
      "voice line prefix", "aud/se/npc/blacked/isabelle/voice lines/",
      "img", "img/npc/girls/blacked/isabelle/portrait_normal.jpg",
      "img dir", "img/npc/girls/blacked/isabelle/portrait_"
    )))

    (set:$relationships's isabelledeltore to (dm:
      "id","isabelledeltore",
      "name","Isabelle",
      "gender","female",
      "respect",0,
      "dom",0,
      "friendship",0,
      "attraction",0,
      "tags",(a:),
      "events",(a:)
    ))
  ]

  (if:(datanames:$blacked_npcs_men) does not contain "jasonbrown")[
    (set:$relationships's jasonbrown to (dm:
      "id","jasonbrown",
      "name","Jason",
      "gender","male",
      "race","black",
      "respect",0,
      "dom",0,
      "friendship",0,
      "attraction",0,
      "tags",(a:),
      "events",(a:)
    ))

    (set:$blacked_npcs_men to it + (dm:"jasonbrown", (dm:
      "id", "jasonbrown",
      "img", "img/npc/guys/blacked/jasonbrown/portrait_normal.jpg",
      "first name", "Jason",
      "last name", "Brown",
      "name", "Jason",
      "sex name", "Jason",
      "unfamiliar name", "handsome black man",
      "race", "black",
      "generation", "millennial",
      "type", "chad",
      "breath", "vodka",
      "age", 25,
      "agecat", "twenties",
      "looks", 8,
      "wealth", 6,
      "stamina", 12,
      "oral skill", 8,
      "fitness", 10,
      "intellect", 6,
      "dominance", 10,
      "hygiene", 7,
      "personality", 8,
      "kissing style", "dominant",
      "tags", (a:"chad", "dominant", "fuckboy"),
      "favorite color", "red",
      "favorite style", "slutty",
      "preference", "tits",
      "alternate names", (a:"he", "the dominant black guy", "the chad"),
      "alternate possessive names", (a:"his", "the dominant guy's"),
      "hands", "strong",
      "events", (a:""),
      "cock",999,
      "ballsdesc","smooth",
      "cockdesc","long",
      "tipdesc","mushroom-shaped",
      "cockrating",9,
      "cockfatness",8,
      "cocklength",9,
      "ballsize",7,
      "cockimg","img/npc/guys/blacked/jasonbrown/cock.jpg"
    )))
  ]

  (if:(datanames:$blacked_npcs_men) does not contain "isiahmaxwell")[
    (set:$relationships's isiahmaxwell to (dm:
      "id","isiahmaxwell",
      "name","Isiah",
      "gender","male",
      "race","black",
      "respect",0,
      "dom",0,
      "friendship",0,
      "attraction",0,
      "tags",(a:),
      "events",(a:)
    ))

    (set:$blacked_npcs_men to it + (dm:"isiahmaxwell", (dm:
      "id", "isiahmaxwell",
      "img", "img/npc/guys/blacked/isiahmaxwell/portrait_normal.jpg",
      "first name", "Isiah",
      "last name", "Maxwell",
      "name", "Isiah",
      "sex name", "Isiah",
      "unfamiliar name", "handsome black man",
      "race", "black",
      "generation", "millennial",
      "type", "lad",
      "breath", "wine",
      "age", 30,
      "agecat", "thirties",
      "looks", 10,
      "wealth", 8,
      "stamina", 14,
      "oral skill", 9,
      "fitness", 10,
      "intellect", 8,
      "dominance", 7,
      "hygiene", 10,
      "personality", 9,
      "kissing style", "passionate",
      "tags", (a:"smells good", "nice", "charming"),
      "favorite color", "white",
      "favorite style", "elegant",
      "preference", "tits",
      "alternate names", (a:"he"),
      "alternate possessive names", (a:"his"),
      "hands", "firm",
      "events", (a:""),
      "cock",999,
      "ballsdesc","full-looking",
      "cockdesc","long",
      "tipdesc","thick",
      "cockrating",9,
      "cockfatness",8,
      "cocklength",9,
      "ballsize",9,
      "cockimg","img/npc/guys/blacked/isiahmaxwell/cock.jpg"
    )))
  ]

  (if:(datanames:$blacked_npcs_men) does not contain "johnjohnson")[
    (set:$relationships's johnjohnson to (dm:
      "id","johnjohnson",
      "name","John",
      "gender","male",
      "race","black",
      "respect",0,
      "dom",0,
      "friendship",0,
      "attraction",0,
      "tags",(a:),
      "events",(a:)
    ))

    (set:$blacked_npcs_men to it + (dm:"johnjohnson", (dm:
      "id", "johnjohnson",
      "img", "img/npc/guys/blacked/johnjohnson/portrait_normal.jpg",
      "first name", "John",
      "last name", "Johnson",
      "name", "John",
      "sex name", "John",
      "unfamiliar name", "rugged black man",
      "race", "black",
      "generation", "millennial",
      "type", "chad",
      "breath", "tequila",
      "age", 32,
      "agecat", "thirties",
      "looks", 8,
      "wealth", 5,
      "stamina", 14,
      "oral skill", 8,
      "fitness", 9,
      "intellect", 6,
      "dominance", 9,
      "hygiene", 7,
      "personality", 7,
      "kissing style", "aggressive",
      "tags", (a:"bully", "chad"),
      "favorite color", "black",
      "favorite style", "sexy",
      "preference", "ass",
      "alternate names", (a:"he"),
      "alternate possessive names", (a:"his"),
      "hands", "manly",
      "events", (a:""),
      "cock",999,
      "ballsdesc","dangling",
      "cockdesc","thick",
      "tipdesc","sculpted",
      "cockrating",9,
      "cockfatness",10,
      "cocklength",8,
      "ballsize",9,
      "cockimg","img/npc/guys/blacked/johnjohnson/cock.jpg"
    )))
  ]

  (if:(datanames:$blacked_npcs_men) does not contain "natturnher")[
    (set:$relationships's natturnher to (dm:
      "id","natturnher",
      "name","Nat",
      "gender","male",
      "race","black",
      "respect",0,
      "dom",0,
      "friendship",0,
      "attraction",0,
      "tags",(a:),
      "events",(a:)
    ))

    (set:$blacked_npcs_men to it + (dm:"natturnher", (dm:
      "id", "natturnher",
      "img", "img/npc/guys/blacked/natturnher/portrait_normal.jpg",
      "first name", "Nat",
      "last name", "Turnher",
      "name", "Nat",
      "sex name", "Nat",
      "unfamiliar name", "muscular black man",
      "race", "black",
      "generation", "genx",
      "type", "chad",
      "breath", "scotch",
      "age", 41,
      "agecat", "forties",
      "looks", 8,
      "wealth", 7,
      "stamina", 12,
      "oral skill", 10,
      "fitness", 9,
      "intellect", 6,
      "dominance", 10,
      "hygiene", 8,
      "personality", 7,
      "kissing style", "dominant",
      "tags", (a:"jock", "chad"),
      "favorite color", "pink",
      "favorite style", "slutty",
      "preference", "ass",
      "alternate names", (a:"he"),
      "alternate possessive names", (a:"his"),
      "hands", "smooth",
      "events", (a:""),
      "cock",999,
      "ballsdesc","bloated",
      "cockdesc","fat",
      "tipdesc","glistening",
      "cockrating",8,
      "cockfatness",9,
      "cocklength",7,
      "ballsize",8,
      "cockimg","img/npc/guys/blacked/natturnher/cock.jpg"
    )))
  ]

  (if:(datanames:$blacked_npcs_men) does not contain "rickyjohnson")[
    (set:$relationships's rickyjohnson to (dm:
      "id","rickyjohnson",
      "name","Ricky",
      "gender","male",
      "race","black",
      "respect",0,
      "dom",0,
      "friendship",0,
      "attraction",0,
      "tags",(a:),
      "events",(a:)
    ))

    (set:$blacked_npcs_men to it + (dm:"rickyjohnson", (dm:
      "id", "rickyjohnson",
      "img", "img/npc/guys/blacked/rickyjohnson/portrait_normal.jpg",
      "first name", "Ricky",
      "last name", "Johnson",
      "name", "Ricky",
      "sex name", "Ricky",
      "unfamiliar name", "ripped young black man",
      "race", "black",
      "generation", "genz",
      "type", "chad",
      "breath", "whisky",
      "age", 23,
      "agecat", "early twenties",
      "looks", 10,
      "wealth", 6,
      "stamina", 14,
      "oral skill", 10,
      "fitness", 10,
      "intellect", 7,
      "dominance", 7,
      "hygiene", 8,
      "personality", 7,
      "kissing style", "aggressive",
      "tags", (a:"fuckboy", "jock"),
      "favorite color", "white",
      "favorite style", "sexy",
      "preference", "tits",
      "alternate names", (a:"he"),
      "alternate possessive names", (a:"his"),
      "hands", "smooth",
      "events", (a:""),
      "cock",999,
      "ballsdesc","tight",
      "cockdesc","long",
      "tipdesc","uncircumcised",
      "cockrating",9,
      "cockfatness",9,
      "cocklength",9,
      "ballsize",7,
      "cockimg","img/npc/guys/blacked/rickyjohnson/cock.jpg"
    )))
  ]

  (if:(datanames:$blacked_npcs_men) does not contain "maurice")[
    (set:$relationships's maurice to (dm:
      "id","maurice",
      "name","Maurice",
      "gender","male",
      "race","black",
      "respect",0,
      "dom",(cond:
        $bar_party's "times" > 0,(max:25,$bar_party's "times" * 2),
        0),
      "friendship",0,
      "attraction",0,
      "tags",(a:),
      "events",(a:)
    ))

    (set:$blacked_npcs_men to it + (dm:"maurice", (dm:
      "id", "maurice",
      "img", "img/npc/guys/blacked/maurice/portrait_normal.jpg",
      "first name", "Maurice",
      "last name", "Pressure",
      "name", "Maurice",
      "sex name", "Maurice",
      "unfamiliar name", "muscular black man",
      "race", "black",
      "generation", "millennial",
      "type", "chad",
      "breath", "rum and coke",
      "age", 33,
      "agecat", "thirties",
      "looks", 9,
      "wealth", 9,
      "stamina", 14,
      "oral skill", 10,
      "fitness", 10,
      "intellect", 8,
      "dominance", 6,
      "hygiene", 8,
      "personality", 8,
      "kissing style", "aggressive",
      "tags", (a:"smells good", "jock", "chad"),
      "favorite color", "yellow",
      "favorite style", "slutty",
      "preference", "tits",
      "alternate names", (a:"he"),
      "alternate possessive names", (a:"his"),
      "hands", "firm",
      "events", (a:"name"),
      "cock",999,
      "ballsdesc","hefty",
      "cockdesc","huge",
      "tipdesc","thick",
      "cockrating",10,
      "cockfatness",10,
      "cocklength",10,
      "ballsize",9,
      "cockimg","img/npc/guys/blacked/maurice/cock.jpg"
    )))
  ]

}

:: blacked voice macro [initialize init_new]
{
  (set:$npc_vo to (macro: str-type _gender, str-type _npc, str-type _line, [
    (if:_gender is "female")[
      (unless:$female_vo is "Female NPC Voiceovers: Disabled")[
        ($play:"sound", (_npc + " " + _line))
      ]
    ] (else-if:_gender is "male")[
      (unless:$male_vo is "Male NPC Voiceovers: Disabled")[
        ($play:"sound", (_npc + " " + _line))
      ]
    ]
    (out:)[]
  ]))
}

:: blacked outfits [initialize init_new]
{
  (set:$outfit_tags to it + (dm:
    "black magnet","Black people are attracted to this outfit.")
  )
}

:: clothes refresh section
{(replace:?section)[($centered:[{
(css:"font-size:0.7em")[(color:$palette_colors's 4th)[üóÇÔ∏è Category]](nl:1)
($show_tooltip:[(link-repeat:"üëö")[(set:$filtered_outfits to (find:_outfit where _outfit's category is "casual",...$outfit_db))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Casual])
($show_tooltip:[(link-repeat:"üëó")[(set:$filtered_outfits to (find:_outfit where _outfit's category is "stylin",...$outfit_db))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Clothes for going out!])
($show_tooltip:[(link-repeat:"üëô")[(set:$filtered_outfits to (find:_outfit where _outfit's category is "beach",...$outfit_db))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Beachwear])
($show_tooltip:[(link-repeat:"ü©≤")[(set:$filtered_outfits to (find:_outfit where _outfit's category is "lingerie",...$outfit_db))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Lingerie])
($show_tooltip:[(link-repeat:"üñ§")[(set:$filtered_outfits to (find:_outfit where _outfit's category is "fetish",...$outfit_db))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Fetishwear])
($show_tooltip:[(link-repeat:"üßò‚Äç‚ôÄÔ∏è")[(set:$filtered_outfits to (find:_outfit where _outfit's category is "gym",...$outfit_db))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Activewear])
($show_tooltip:[(link-repeat:"üõãÔ∏è")[(set:$filtered_outfits to (find:_outfit where _outfit's category is "lounge",...$outfit_db))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Loungewear - pajamas and other comfy stuff])
($show_tooltip:[(link-repeat:"üë†")[(set:$filtered_outfits to (find:_outfit where _outfit's category is "office",...$outfit_db))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Officewear])
($show_tooltip:[(link-repeat:"üÜï")[(set:$filtered_outfits to (find:_outfit where not ($outfit_inventory contains (text:_outfit's id)),...$outfit_db))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Outfits not owned])
($show_tooltip:[(link-repeat:"üîÑ")[(set:$filtered_outfits to $outfit_db)(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Clear filter (view all outfits)])
(nl:1)
(color:$palette_colors's 4th)[($show_tooltip:[(css:"font-size:0.7em")[üîÄ Sort by]],[Sort within the current filter - note that you'll have to re-click this whenever you apply a new filter.])](nl:1)
($show_tooltip:[(link-repeat:"üîºüíµ")[(set:$filtered_outfits to (sorted: via its price,...$filtered_outfits))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Sort by price, low to high])
($show_tooltip:[(link-repeat:"üîºüëÑ")[(set:$filtered_outfits to (sorted: via its sluttiness,...$filtered_outfits))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Sort by sluttiness, low to high])
($show_tooltip:[(link-repeat:"üîºüòå")[(set:$filtered_outfits to (sorted: via its comfort,...$filtered_outfits))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Sort by comfort, low to high])(nl:1)
($show_tooltip:[(link-repeat:"üîΩüíµ")[(set:$filtered_outfits to (sorted: via its price*-1,...$filtered_outfits))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Sort by price, high to low])
($show_tooltip:[(link-repeat:"üîΩüëÑ")[(set:$filtered_outfits to (sorted: via its sluttiness*-1,...$filtered_outfits))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Sort by sluttiness, high to low])
($show_tooltip:[(link-repeat:"üîΩüòå")[(set:$filtered_outfits to (sorted: via its comfort*-1,...$filtered_outfits))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Sort by comfort, high to low])(nl:1)
(color:$palette_colors's 4th)[($show_tooltip:[(css:"font-size:0.7em")[‚ûï Additional filters]],[Filter WITHIN the current filter - note that you'll have to re-click this whenever you apply a new filter.])](nl:1)
($show_tooltip:[(link-repeat:"üÜï")[(set:$filtered_outfits to (find:_outfit where not ($outfit_inventory contains (text:_outfit's id)),...$filtered_outfits))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Outfits not owned WITHIN current filter criteria.])($show_tooltip:[(link-repeat:"üè∑Ô∏è")[(set:$filtered_outfits to (find:_outfit where _outfit's price <= $character's money,...$filtered_outfits))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Outfits you can afford.])($show_tooltip:[(link-repeat:"üïπÔ∏è")[(set:$filtered_outfits to (find:_outfit where _outfit's tags contains any of (a:"professional","very professional","chores","workout","great workout","gym scene"),...$filtered_outfits))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Outfits with stat bonuses or unlockable scenes.])($show_tooltip:[(link-repeat:"‚ô†Ô∏è")[(set:$filtered_outfits to (find:_outfit where (_outfit's tags contains "blacked"),...$filtered_outfits))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Special BLACKED section?])(if:(is_bim:))[($show_tooltip:[(link-repeat:"üéÄ")[(set:$filtered_outfits to (find:_outfit where (_outfit's colors contains "pink"),...$filtered_outfits))(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)]],[Pink outfits!!! EeEEeeeee!!!])](nl:1)
(color:$palette_colors's 4th)[($show_tooltip:[(css:"font-size:0.7em")[üìÑ Outfits per page]],[How many outfits will be visible on screen at once.])](nl:1)
<span class='borderless'>|pagination_settings>[(for: each _setting, 8, 16, 32, 64, 128, 256)[(color:(cond:$clothes_pagination is _setting,"bisque",$palette_colors's 4th))[(link-repeat:(text:_setting))[(set:$clothes_pagination to _setting)(display:"clothes shopping outfit reset pagination")(rerun:?outfit_display)(rerun:?pagination_settings)]]]]</span>(nl:2)(link:"Back")[($nx:"clothes shopping")]}])]}


:: npc race check
{
  (set:_setting to (dm:
  "Black Encounters: Never", 0,
  "Black Encounters: Less", 1,
  "Black Encounters: Normal", 2,
  "Black Encounters: More", 3,
  "Black Encounters: Always", 4
  ))

  (set:_magnet to (cond:$outfit's "tags" contains "black magnet",1,0))
  (set:_freq to 0)

  <!-- Uplevel encounter setting if wearing BLACKED outfit-->
  (unless: $blackfreq of _setting is 0)[(set:_freq to $blackfreq of _setting + _magnet)]

  (set:$racecheck to (cond:
    _freq is 1 and (twist:1,3) is 1, "black",
    _freq is 2 and (twist:1,2) is 1, "black",
    _freq is 3 and (twist:1,3) is not 1, "black",
    _freq > 3, "black",
    _freq is 0, "white",
    ,"white"
  ))
}

:: secretary coworker approach [around]
{
  (set:$force_white_guy to true)
  (display:_around)
}

:: secretary work finished [around]
{
  (set:$force_white_guy to false)
  (display:_around)
}

:: generate random guy [around]
{
  (if:$npc_type is "coworker" and $current_activity is "Go to the mall")[(display:_around)]
  (else-if:$force_white_guy is true)[(display:_around)]
  (else:)[
    (display:"npc race check")
    (if:$racecheck is "black" and $blacked_compatible is 1)[
      (display:"generate black guy")]
    (else:)[(display:_around)]
  ]
}

:: generate black guy
{
  (if:$min_npc_age is 0)[(set:$min_npc_age to "Min Age: 18")]
  (if:$max_npc_age is 0)[(set:$max_npc_age to "Max Age: 55")]

  (set:_min_age to (num: 1st of (str-find: (p-many: digit), $min_npc_age)))
  (set:_max_age to (num: 1st of (str-find: (p-many: digit), $max_npc_age)))
  (set:_max_age to (cond: (twist:1,2) is 1, 30, _max_age))
  (set:_age to (twist:_min_age, _max_age))
  (set:_agecat to (cond:
    _age < 20, "late teens",
    _age < 25, "early twenties",
    _age < 30, "twenties",
    _age < 40, "thirties",
    _age < 50, "forties",
    "fifties"
  ))
  (set:_generation to (cond: _age < 24, "genz", _age < 38, "millenial", "genx"))

  (set:_activity_list to (dm:
    "Go to work","coworker",
    "Go to the beach","beach",
    "Go to the mall","mall",
    "Workout","gym",
    "Hit the bar","bar",
    "Go clubbing","club"
  ))

  (set:_type to "generic")
  (if:(dmnames:_activity_list) contains $current_activity)[
    (set:_type to $current_activity of _activity_list)
  ]

  (set:$blacked_types to (cond:
    _type is "bar",(altered: via (str: it), ...(range:85,99)),
    (altered: via (str: it), ...(range:90,99))))

  (if:$npc_type is "coworker")[
    (if:$coworkers is 0)[(set:$coworkers to (a:))]
    (for: each _coworker, ...$coworkers)[(set:$blacked_types to it - (a:(text:(words:_coworker)'s 3rd)))]
  ]

  (set:str-type _variant to (text:(twirl:...$blacked_types)))

  (set:_img to "img/npc/guys/generated/" + _generation + "/" + _type + "/" + _variant + ".jpg")

  ($use_global: "$black_cock_database", "window.GE.black_cock_database", [{
    (set:$npc to (dm:
      "tags", (a:),
      "events", (a:),
      "race", "black",
      "stamina", (twist:8,15),
      "oral skill", (twist:1,10),
      "kissing style", "normal",
      "alternate names", (a:),
      "alternate possessive names", (a:),
      "favorite color", (twirl:"red","white","black","yellow","purple","pink","orange"),
      "favorite style", (twirl:"elegant","slutty","cute","casual","sexy"),
      "age", _age,
      "agecat", _agecat,
      "generation", _generation,
      "type", _type,
      "img", _img,
      "last name", "Smith",
      "preference", (twirl:"ass","tits")
    ) + (twirl: ...$black_cock_database))
    }])

  (if:(twist:1,2) is 1)[
    (set:$npc's "stamina" to (min:$npc's "stamina", (cock:"rating","npc") + 5))
  ]

  (set:$npc's "variant" to _variant)

  (if:_agecat is "late teens")[
    (set:"alternate names" of $npc to it + (a:"he","the teen"))
    (set:"alternate possessive names" of $npc to it + (a:"his","the teen's"))
  ](else-if:_agecat is "fifties")[
    (set:"alternate names" of $npc to it + (a:"he","the old guy"))
    (set:"alternate possessive names" of $npc to it + (a:"his","the old guy's"))
  ]

  (set: _wealth_range to (cond: 
    _generation is "genx", (a: 5, 10),
    _generation is "millenial", (a: 1, 10),
    _generation is "genz" and (twist:1,4) is 1, (a: 1, 10),
    (a: 1, 4)
  ))

  (set: wealth of $npc to (twist: _wealth_range's 1st, _wealth_range's 2nd))

  (set: _guys to (cond:
      _generation is "millenial", (a: "guy", "dude", "guy", "dude", "guy", "fellow"),
      _generation is "genz" and age of $npc < 20, (a: "dude", "guy", "fellow", "teen", "teenager", "teen", "boy"),
      _generation is "genz", (a: "dude", "guy", "fellow", "twenty-something"),
      (a: "man", "guy")
  ))
  (set: _guy to (twirl: ..._guys))

  ($use_global: '$guy_database', 'window.GE.guy_database', [{
    (set:_generation_guys to _generation of $guy_database)
    (set:_npc to _variant of _type of _generation_guys)

    (set:"unfamiliar name" of _npc to (replaced:"_guy", _guy, (twirl:..."unfamiliar names" of _npc)))
    (set:"description" of _npc to (replaced:"_guy", _guy, (twirl:..."descriptions" of _npc)))
    (set:"first name" of _npc to (twirl:...("first names" of _generation_guys)))
    (set:"hands" of _npc to (twirl:...("hands" of _generation_guys)))

    (set:$npc to it + _npc)
  }])
  (set:$npc's "unfamiliar name" to (upperfirst:it))


  (set: intellect of $npc to (cond: 
      ($npc's tags contains "fuckboy") or ($npc's tags contains "jock"), (twist: 1, 5),
      ($npc's tags contains "nerd"), (twist: 5, 10),
      (twist: 1, 10)
  ))

  (set: fitness of $npc to (cond: 
      ($npc's tags contains "nerd") or ($npc's tags contains "chubby"), (twist: 1, 5),
      ($npc's tags contains "jock") or ($npc's tags contains "chad"), (twist: 5, 10),
      (twist: 1, 10)
  ))

  (if: fitness of $npc > 8)[
      (set: $npc's tags to it + (a: "jock"))
  ]

  (display:"generate black guy name")

  (set:"name" of $npc to (cond:_age > 35, "Mr. " + "last name" of $npc, "first name" of $npc))
  (set:$npc's "sex name" to (upperfirst:$npc's "name"))

  (if:length of $npc's "tags" is 0)[
    (set:$npc's tags to it + (a:(twirl:"selfish","nice","unremarkable","cool")))
  ]
  (if:$npc's "tags" contains "fuckboy")[
    (set:$npc's tags to it + (a:"selfish"))
  ]
  (if:$npc's "tags" contains "bully" or $npc's "tags" contains "smug")[
    (set:$npc's tags to it + (a:"selfish"))
  ]

  (set: _personalityRange to (cond:
    $npc's "tags" contains "gentleman", (a: 7, 10),
    $npc's "tags" contains "nice", (a: 5, 10),
    $npc's "tags" contains any of (a: "cool", "charming", "jock"), (a: 5, 8),
    $npc's "tags" contains "unremarkable", (a: 4, 6),
    $npc's "tags" contains any of (a: "annoying", "creepy"), (a: 1, 5),
    $npc's "tags" contains any of (a: "selfish", "fuckboy", "bully"), (a: 1, 6),
    (a: 1, 10)
  ))
  (set: $npc's "personality" to (twist: _personalityRange's 1st, _personalityRange's 2nd))

  (if: $npc's "tags" contains "charming")[ 
      (set: $npc's "alternate names" to it + (a: "he", "the charming guy"))
      (set: $npc's "alternate possessive names" to it + (a: "his", "the charming guy's"))
  ](else-if: $npc's "tags" contains "gentleman")[ 
      (set: $npc's "alternate names" to it + (a: "he", "the gentleman"))
      (set: $npc's "alternate possessive names" to it + (a: "his", "the gentleman's"))
  ]

  (display:"npc outfit modifiers")

  (set: $npc's "hygiene" to (cond: 
      $npc's "tags" contains "gentleman", (twist: 5, 10),
      $npc's "tags" contains "smells good", (twist: 7, 10),
      $npc's "tags" contains "charming", (twist: 5, 8),
      $npc's "tags" contains "smelly", (twist: 1, 3),
      $npc's "tags" contains "chubby", (twist: 1, 6),
      $npc's "tags" contains "chad", (twist: 3, 7),
      $npc's "tags" contains "nerd", (twist: 1, 7),
      (twist: 1, 10)
  ))

  (set: $npc's "hands" to (cond: 
      $npc's "tags" contains any of (a: "chubby"), (twirl: "pudgy", "chubby"),
      $npc's "tags" contains any of (a: "chad"), (twirl: "strong", "firm", "manly"),
      $npc's "tags" contains any of (a: "nerd", "smelly"), (twirl: "clammy", "sweaty", "soft"),
      $npc's "tags" contains "gentleman", (twirl: "firm", "smooth", "graceful", "gentlemanly"),
      "firm"
  ))

  (set: $npc's "kissing style" to (cond: 
      $npc's "tags" contains any of (a:"fuckboy","jock","aggressive"),"aggressive",
      $npc's "tags" contains any of (a: "charming", "chad", "dominant"), "dominant",
      $npc's "tags" contains "nerd", (twirl: "weak", "slobber", "normal"),
      $npc's "tags" contains "smelly", "gross",
      "normal"
  ))

  (if:$npc's "tags" contains "chad")[
    (set:$npc's "alternate possessive names" to it + (a:"his","the chad's"))
  ]
  (if:$npc's "tags" contains "nerd")[
    (set:$npc's "alternate possessive names" to it + (a:"his","the nerd's"))
  ]

  (display:"guy breath update")

  (if:$npc's "tags" contains "breeder")[
    (set:$npc's tags to it - (a:"gentleman"))
    (set:$npc's personality to (min:it,5))
    ($use_global: "$black_cock_database", "window.GE.black_cock_database", [(set:$npc to it + (twirl:...(find:_cock where _cock's ballsize is 10, ...$black_cock_database)))])
  ]
  (set:$npc's age to (max:18,it))

  (set: $npc's dominance to (cond:
      $npc's tags contains any of (a: "chad", "bully", "jock", "breeder"), (twist: 8, 10),
      $npc's age < 22 or $npc's tags contains "nerd", (twist: 2, 6),
      $npc's age > 34, (twist: 4, 8),
      (twist: 1, 10)
  ))

  (if:$npc_type is "coworker")[
    (set:$npc's tags to $npc's tags + (a:"coworker"))
    (if:$npc's tags contains "executive")[
      (set:$npc's "sales level" to (twist:8,10))
    ]
    (else:)[
      (set:$npc's "sales level" to (cond:$npc's age >= 55,(twist:6,10),$npc's age >= 50,(twist:7,8),$npc's age >= 40,(twist:5,8),$npc's age >= 30,(twist:4,6),$npc's age >= 20,(twist:1,5),$npc's age >= 18,(twist:1,4)))
      (if:$npc's tags contains "ambitious")[(set:$npc's "sales level" to it + (twist:1,3))]
      (if:$npc's tags contains "lazy")[(set:$npc's "sales level" to it - (twist:1,3))]
    ]
      
    (unless:$npc's "tags" contains "coworker")[(set:$npc's "tags" to it + (a:"coworker"))]    
    (set:$npc's "sales level" to (max:1,(min:$npc's "sales level",10)))

    (set:$npc's "wealth" to (cond:
      $npc's "tags" contains "wealthy",(twist:8,10),
      $npc's "tags" contains "rich",10,
      $npc's "sales level"))
    
    (display:"npc generate id coworker")
    (set:$npc's "events" to it + (a:"your name"))
    (set:$relationships's (text: "npc " + (text:$npc's "id")) to (dm:
      "id",(text: "npc " + (text:$npc's "id")),
      "name",$npc's name,
      "gender","male",
      "respect",0,
      "dom",0,
      "friendship",0,
      "attraction",0,
      "tags",(a:"coworker")
    ))
  ](else:)[    
    (display:"npc generate id")
  ]

  (set:$npc's appeal to $npc's looks)
  (display:"alcohol modify appeal")
}

:: generate black guy name
{
(set:"first name" of $npc to (twirl:"Rod","Jax","Marcus","Damion","Rob","Booker","Emmett","Dontrell","Tyrone","Keenan","Lamonte","Tyrus","Darius","Jamal","Marcel","Warren","Lex","DeAngelo","Jayce","Omar","Andre","Shane","Oscar","Autry","Malik","Terrell","Devon","Marquise","Lorenzo","Xavier","Antoine","Rashad","Kendall","Leon","Deshawn","Javon","Kendrick","Maurice","Isaiah","Dante","Lamont","Quincy","Tobias","Trey","Cedric","Dominic","Carlton","Byron","Tyrell","Aaron")) 
(set:"last name" of $npc to (twirl:"Jackson","Johnson","Diggler","Piper","Harden","Black","Jackson","Davis","Wilson","Thompson","Michaels","Strong","Mac","Ross","Hard","Long","Anderson","Carter","Harris","Walker","Robinson","Lewis","Hill","Moore","Adams","King","Brown","Green","Turner","Brooks","Young","Allen","Carter","Taylor","Clark","Hall","Wright","Scott","Stewart","Parker","Porter","Collins","Reed","Howard","Mitchell","Watson","Bryant","Foster","Barnes","Alexander","Coleman","Jenkins")) 
}

:: blacked dance time [dance_time]
{}

:: blacked buy girl drink [buy_girl_drink]
{}

:: blacked girl pickup line success [girl_pickup_line_success]
{}

:: blacked girl number [girl_number]
{}

:: blacked girl approach [girl_approach]
{}

:: blacked male npc approach [male_npc_approach]
{
  <!-- QoS arousal impact -->
  (if:not (checkdm:$npc, "race", "is", "black"))[
    (if:(is_QoS:))[
      (unless:$character's "arousal" is 0)[
        (set:$character's "arousal" to (floor:it / 2))
        ($notification:"Arousal Lessened (Queen of Spades)üëë")(nl:1)
        (display:$stats_refresh)
      ]
    ]
  ]
  (if:(checkdm:$npc, "race", "is", "black"))[
    (if:(is_QoS:))[
      (set:$character's "arousal" to (round:it * 2))
        ($notification:"Arousal Heightened (Queen of Spades)üëë")(nl:1)
        (display:$stats_refresh)
    ]
  ]
}

:: blacked take pill [take_pill]
{}

:: blacked orgasm sex [orgasm_sex]
{}

:: blacked interrupt_chance [interrupt_chance]
{}

:: blacked check buffs [check_buffs]
{}

:: blacked wear clothes [wear_clothes]
{
  (if:$outfit's tags contains "blacked")[(display:"blacked trigger outfit")]
}

:: blacked npc alt portrait [number_gain_male]
{
  (if:not (checkdm:$npc, "type", "is", "generic"))[
    (if:(checkdm:$npc, "race", "is", "black"))[
      (unless:$npc's "id" is "dredd")[
        (set:$npc's "img" to "img/npc/guys/generated/" + $npc's "generation" + "/"+ $npc's "type" +"/alt/" + $npc's "variant" + ".jpg")
        (display:"save npc male")
      ]
    ]

    (set:$black_fuckbuddies to (a:))
    (for: each _npc, ...((datanames:$npcs_men)-(a:"dredd","bruce","stepdad")))[
      (if:$npcs_men's (str: _npc)'s "race" is "black" and $npcs_men's (str: _npc)'s "tags" contains "generic npc")[
          (if:$relationships's (str:"npc "+_npc)'s "tags" contains "fuckbuddy")[(set:$black_fuckbuddies to it + (a:_npc))
      ]]]
    (if:((passage:"__mods__")'s source contains "Dredding Intimacy"))[
      (if:$relationships's "dredd"'s "tags" contains "fuckbuddy")[(set:$black_fuckbuddies to it + (a:"dredd"))]
    ]
    (if:length of $black_fuckbuddies >= 5)[(display:"blacked trigger hood bicyle")]
    ]
}

:: blacked new pregnancy [new_pregnancy]
{
  (if:(checkdm:$preg_npc, "race", "is", "black"))[
    (set:$blacked_stats's "times fertilized" to it + 1)
  ]
}

:: blacked newly discovered pregnancy [newly_discovered_pregnancy]
{
  (if:$blacked_stats's "times fertilized" is 1)[(display:"blacked trigger first pregnancy")]
  (else-if:$blacked_stats's "times fertilized" is 5)[(display:"blacked trigger fifth pregnancy")]
}

:: blacked npc cock rating [npc_cock_rating] 
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (if:(cock:"girth","npc") is 10 and (cock:"length","npc") is 10 and (cock:"balls","npc") is 10)[(display:"blacked trigger moby dick")]
    (if:(cock:"rating","npc") >= 9)[(set:$blacked_stats's "big cocks" to it + 1)]
    (if:$blacked_stats's "big cocks" >= 15)[(display:"blacked trigger size queen")]

    (if:(is_QoS:))[
      <!-- Positive arousal/lubrication impact for QoS -->
      (set:$gain to (round:$gain * 2))
      ($notification:"Arousal Heightened (Queen of Spades)üëë")
    ]
  ]

  (else:)[
    (if:(is_QoS:))[
      <!-- Negative arousal/lubrication impact for QoS -->
      (set:$gain to (floor:$gain / 2))
      ($notification:"Arousal Lessened (Queen of Spades)üëë")
    ]
  ]
}

:: blacked position pleasure [position_your_pleasure]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    <!-- Revert Pregmod's Size Queen side effect for pleasure-->
    (if:((passage:"__mods__")'s source contains "Pregmod") and (is_bbc_sizequeen:))[
      (if:$select_position's "position" is "doggystyle")[
        (if:(cock:"rating","npc") > 9 and ($character's "side effects" contains "Size Queen"))[
        (set:$select_position's "your pleasure" to it - 4)
        ]
      ]
    ]
  ]
}

:: gain pleasure [around]
{
  (unless:$gain is 0)[
    (if:(checkdm:$npc, "race", "is", "black"))[
      (if:($npc's cock is "in you"))[
        (if:(is_bbc_sizequeen:))[
          (unless:(datanames:$npc) contains "cockrating")[
            (set:$npc's "cockrating" to 9)
          ]
          (if:(cock:"rating","npc") >= 9)[
            (set:$gain to $gain * 1.5)
            <div class='options'><mark>+50% Pleasure(BBC Size Queen)üìè</mark></div>
          ]
          (else-if:(cock:"rating","npc") < 7)[
            (set:$gain to $gain / 2)
            <div class='options'><mark>Pleasure Halved (BBC Size Queen)üìè</mark></div>
          ]
        ]
        (set:$gain to (floor:$gain))
      ]
    ]
    (else:)[
      (if:($npc's cock is "in you"))[
        (unless:((passage:"__mods__")'s source contains "Pregmod"))[
          (if:(is_bbc_sizequeen:))[
            (unless:(datanames:$npc) contains "cockrating")[
              (set:$npc's "cockrating" to 9)
            ]
            (if:(cock:"rating","npc") < 7)[
              (set:$gain to (floor:$gain / 2))
              <div class='options'><mark>Pleasure Halved (BBC Size Queen)üìè</mark></div>
            ]
          ]
        ]
      ]
    ]
  ]
  (display:_around)
}

:: blacked sex finish [sex_finish]
{
  (if:$npc's race is not "black")[
    (if:$npc's cockrating < 7 and $blacked_stats "sex as girl" is 0)[
      ($generate_specific_curiosity:"After that sad excuse for a cock, you find yourself thinking about ","finding out the truth about black guys. Is it true what they say? Are they really bigger?")
    ]
    (if:(is_bbc_addict: and $orgasms > 1))[
      (set:$cause_text to "since you orgasmed more than once without a BBC")
      (set:$effect_text to "ignoring your BBC addiction")
      (display:"blacked mood ashamed")
    ]
    (else:(is_bbc_addict:) and $orgasm <= 1)[
      (set:$cause_text to "since you failed to sleep with a black man")
      (set:$effect_text to "ignoring your BBC addiction")
      (display:"blacked mood unsatisfied")
    ]
    (if:(is_QoS:))[
      (display:"blacked QoS debuff")
    ]
  ]
  (else-if:$npc's race is "black")[
    (display:"blacked bbc sex checks")
    ]
}

:: blacked watch porn [watch_porn]
{
  (if:$select contains "bbc" or $select contains "black cock")[
    (set:$blacked_stats's "bbc porn watched" to it + 1)
    (set:$blacked_daily_stats's "bbc porn watched" to it + 1)
    (set:$curiosity_check to "bbc porn")(display:"curiosity check")
    (if:($has_ap_mod:"bbc porn mod"))[(display:"action point mod trigger")]
    (if:$blacked_stats's "bbc porn watched" >= 50)[(display:"blacked trigger gooner")]
  ]
}


:: watch porn [around]
{
  <!-- Temp workaround until 0.21.6 -->
  (if:$porn contains "black cock heaven")[
    (unless: length of (find:_disc where _disc's name is "black cock heaven",...$porn_list) > 0)[(display:"add porn black cock heaven")]
  ]
  (if:$porn contains "bbc babecock")[
    (unless: length of (find:_disc where _disc's name is "bbc babecock",...$porn_list) > 0)[(display:"add porn bbc babecock")]
  ]
  (if:$porn contains "bbc pmvs")[
    (unless: length of (find:_disc where _disc's name is "bbc pmvs",...$porn_list) > 0)[(display:"add porn bbc pmvs")]
  ]

  (display:_around)

  (if:$blacked_events contains "gooner part one" and $blacked_events does not contain "black cock heaven")[
    (if:$porn_list does not contain "black cock heaven")[(display:"add porn black cock heaven")]
    (replace:?options)[
      Huh, that's weird. I don't remember buying <span class='chromatic'>BLACK COCK HEAVEN</span>... I wonder how it got here.
      (set:$porn to it + (a:"black cock heaven"))
      (set:$blacked_events to it + (a:"black cock heaven"))
        (nl:2)
        (print: "BBC Porn:")(nl:1)
        (link: "BLACK`_`COCK`_`HEAVEN.EXE")[
          (set: $select to "black cock heaven")(set: $type to "bbc")(display: "watch porn disk")(nl:1)
        ]
        (link:"Back")[($cs:"use computer")]
    ]
    
  ]
  (if:$blacked_events contains "gooner part two" and $blacked_events does not contain "bbc pmvs")[
    (if:$porn_list does not contain "bbc pmvs")[(display:"add porn bbc pmvs")]
    (replace:?options)[
      Huh, that's weird. I don't remember buying <span class='chromatic'>BBC PMVS</span>. What are PMVS?
      (set:$porn to it + (a:"bbc pmvs"))
      (set:$blacked_events to it + (a:"bbc pmvs"))
        (nl:2)
        (print: "BBC Porn:")(nl:1)
        (link: "BBC`_`PMVS.EXE")[
          (set: $select to "bbc pmvs")(set: $type to "bbc")(display: "watch porn disk")(nl:1)
        ]
        (link:"Back")[($cs:"use computer")]
    ]
  ]
}

:: register receive facial [around]
{
  (display:_around)
  (if:(checkdm:$npc, "race", "is", "black"))[
    (set:$blacked_stats's "facials received" to it + 1)
    (set:$blacked_daily_stats's "facials received" to it + 1)
  ]
}

:: sex creampie closeup [around]
{
  (display:_around)
  (if:(checkdm:$npc, "race", "is", "black"))[
    (set:$blacked_stats's "creampies received" to it + 1)
    (set:$blacked_daily_stats's "creampies received" to it + 1)
    (if:(pill:"Breeder"))[
      (set:$blacked_daily_stats's "breeder creampies" to it + 1)
      (if:$blacked_daily_stats's "breeder creampies" is 3)[(display:"blacked trigger breeder")]
      ]
    (set:$curiosity_check to "black creampie")(display:"curiosity check")
    ]
}

:: girl lick [around]
{
  (display:_around)
  (if:(checkdm:$character, "race", "is", "black"))[
    (set:$blacked_stats's "cunnilingus given as guy" to it + 1)
    (set:$blacked_daily_stats's "cunnilingus given as guy" to it + 1)
  ]
}

:: girl cum [around]
{
  (display:_around)
  (if:$npc's race is not "black" and $character's race is "black")[
    (if:$type is "creampie")[
      (set:$blacked_stats's "creampies given" to it + 1)
      (set:$blacked_daily_stats's "creampies given" to it + 1)
      (if:$npc's race is "white")[(set:$curiosity_check to "white girl creampie")(display:"curiosity check")]
      ]
    (else-if:$type is "pull out")[
      (set:$blacked_stats's "came on body" to it + 1)
      (set:$blacked_daily_stats's "came on body" to it + 1)
    ]
    (else-if:$type is "facial")[
      (set:$blacked_stats's "facials given" to it + 1)
      (set:$blacked_daily_stats's "facials given" to it + 1)
    ]
    (else-if:$type is "mouth")[
      (set:$blacked_stats's "came in mouth" to it + 1)
      (set:$blacked_daily_stats's "came in mouth" to it + 1)
    ]
    (else-if:$type is "cum tits")[
      (set:$blacked_stats's "came on tits" to it + 1)
      (set:$blacked_daily_stats's "came on tits" to it + 1)
    ]
    ]
}

:: register fuck girl [around]
{
  (display:_around)
  (if:(checkdm:$character, "race", "is", "black"))[
    (set:$blacked_stats's "sex as guy" to it + 1)
    (set:$blacked_daily_stats's "sex as guy" to it + 1)
    (if:(checkdm:$npc, "race", "is", "white"))[
      (set:$curiosity_check to "white girl fuck")(display:"curiosity check")
    ]
  ]
}

:: jungle waterfall hikers [around]
{
  (display:_around)
  (if:$stage is 8 or $stage is 9) [
    (if:(checkdm:$character, "race", "is", "black"))[
      (set:$blacked_stats's "blowjobs received" to it + 1)
      (set:$blacked_daily_stats's "blowjobs received" to it + 1)
    ]
  ]
}

:: alexia motel 6 [around]
{
  (display:_around)
  (if:$stage is 8 or $stage is 9) [
    (if:(checkdm:$character, "race", "is", "black"))[
      (set:$blacked_stats's "blowjobs received" to it + 1)
      (set:$blacked_daily_stats's "blowjobs received" to it + 1)
    ]
  ]
}

:: girl sex add stats [around]
{
  (display:_around)
  (if:(checkdm:$character, "race", "is", "black"))[
    (if:$sex_events contains "blowjobs received")[
      (set:$blacked_stats's "blowjobs received" to it + 1)
      (set:$blacked_daily_stats's "blowjobs received" to it + 1)
    ]
  ]
}

:: proposition reject success [around]
{
  (display:_around)
  (if:$npc's "race" is not "black")[
    (set:$blacked_stats's "rejections" to it + 1)
    (set:$blacked_daily_stats's "rejections" to it + 1)
    (display:"blacked rejection tally")
    (if:(is_QoS:))[
      (display:"blacked QoS buff")
    ]
  ]
}

:: proposition reject bj aroused result [around]
{
  (if:(win:))[
    (if:$npc's "race" is not "black")[
      (set:$blacked_stats's "rejections" to it + 1)
      (set:$blacked_daily_stats's "rejections" to it + 1)
      (display:"blacked rejection tally")
      (if:(is_QoS:))[
        (display:"blacked QoS buff")
      ]
    ]
  ]
  (display:_around)
}

:: proposition reject fuck aroused result [around]
{
  (if:(win:))[
    (if:$npc's "race" is not "black")[
      (set:$blacked_stats's "rejections" to it + 1)
      (set:$blacked_daily_stats's "rejections" to it + 1)
      (display:"blacked rejection tally")
      (if:(is_QoS:))[
        (display:"blacked QoS buff")
      ]
    ]
  ]
  (display:_around)
}

:: catcall guy leaves [around]
{
  (if:$npc's "race" is not "black")[
    (set:$blacked_stats's "rejections" to it + 1)
    (set:$blacked_daily_stats's "rejections" to it + 1)
    (display:"blacked rejection tally")
    (if:(is_QoS:))[
      (display:"blacked QoS buff")
    ]
  ]
  (display:_around)
}

:: beach sex area [around]
{
  (display:_around)
  (if:(checkdm:$npc, "race", "is", "black"))[
    (set:$blacked_daily_stats's "beach sex" to it + 1)
  ]
}

:: bar dance start blowjob [around]
{
  (display:_around)
  (set:$blacked_stats's "blowjobs given" to it + 1)
  (set:$blacked_daily_stats's "blowjobs given" to it + 1)
}

:: bar dance start sex [around]
{
  (display:_around)
  (display:"blacked bbc sex checks")
}

:: dredd job sex finish [around]
{
  (display:_around)
  (inc:"dredd's visits")
  (if:$bar_party's times >= 10)[(display:"blacked trigger besties")]
  (display:"blacked bbc sex checks")
}

:: bar dance end final [around]
{
  (display:_around)
  (if:$bar_dance's "times danced" >= 10)[(display:"blacked trigger stripper")]
}

:: invite guy sex intro stepdad [around]
{
  (if:$npc's race is "black" and $npc's age >= 40)[(display:"blacked trigger new daddy")]
  (display:_around)
}

:: register swallow [around]
{
  (display:_around)
  (if:(checkdm:$npc, "race", "is", "black"))[
    (set:$blacked_stats's "loads swallowed" to it + 1)
    (set:$blacked_daily_stats's "loads swallowed" to it + 1)
    (display:"blacked swallow tally")
  ]
}

:: blacked sex tally
{
  (if:$blacked_daily_stats's "sex as girl" >= 5)[(display:"blacked trigger sex5")]
  (if:$blacked_stats's "sex as girl" is 1)[(display:"blacked trigger first sex")]
  (else-if:$blacked_stats's "sex as girl" >= 100)[(display:"blacked trigger sex100")]
  (else-if:$blacked_stats's "sex as girl" >= 50)[(display:"blacked trigger sex50")]
  (else-if:$blacked_stats's "sex as girl" >= 25)[(display:"blacked trigger sex25")]
}

:: blacked swallow tally
{
  (if:$blacked_stats's "loads swallowed" >= 100)[(display:"blacked trigger swallow100")]
  (else-if:$blacked_stats's "loads swallowed" >= 50)[(display:"blacked trigger swallow50")]
  (else-if:$blacked_stats's "loads swallowed" >= 25)[(display:"blacked trigger swallow25")]
}

:: blacked rejection tally
{
  (if:$blacked_stats's "rejections" >= 100)[(display:"blacked trigger reject100")]
  (else-if:$blacked_stats's "rejections" >= 50)[(display:"blacked trigger reject50")]
  (else-if:$blacked_stats's "rejections" >= 25)[(display:"blacked trigger reject25")]
}

:: blacked side effects init [init_side_effects]
{
  (set:$side_effect_names to it + (dm:
    "QoS","üëë Queen of Spades ‚ô†Ô∏è",
    "bbc sizequeen","BBC Size Queen",
    "bbc sizequeen temp","BBC Size Queen",
    "bbc addiction","Addicted to BBC",
    "bbc addiction temp","Addicted to BBC"
  ))

  (set:$side_effect_descriptions to it + (dm:
    "QoS", "Once you go black... you never go back. It's more than a preference, you will find it nearly impossible to resist Black men.",
    "bbc sizequeen","You've been stretched out from taking all those Big Black Cocks! Small dicks are much less effective on you now.",
    "bbc sizequeen temp","You've been stretched out from taking all those Big Black Cocks! Small dicks are much less effective on you now.",
    "bbc addiction","BBC is constantly on your mind. Going too long without it could be bad...",
    "bbc addiction temp","BBC is constantly on your mind. Going too long without it could be bad..."
  ))

  (set:$temp_side_effects to it + (a:"bbc addiction temp", "bbc sizequeen temp"))
}

:: Blacked New-U Side Effect Check
{
  (if:$blackfreq is "Black Encounters: Never")[(set:$blacked_compatible to 0)]
  (else-if:(checkdm:$blacked_compatible_list, ($new_stats's id),"is",1))[
    (set:$blacked_compatible to 1)]
  (else:)[(set:$blacked_compatible to 0)]

  (if:$blacked_compatible is 1)[
    (set:$newu_side_effects to it + (dm:
    "bbc addiction temp","Bonuses for sleeping with Black men. Punishments for going without.",
    "bbc sizequeen temp","Extra pleasure for *Big Black Cocks*. Less pleasure for tiny cocks."
    ))
  ](else:)[
    (if:(dmnames:$newu_side_effects) contains "bbc addiction temp")[
      (move:$newu_side_effects's "bbc addiction temp" into _buffer)
    ]
    (if:(dmnames:$newu_side_effects) contains "bbc sizequeen temp")[
      (move:$newu_side_effects's "bbc sizequeen temp" into _buffer)
    ]
  ]
}

:: blacked QoS buff
{
  (set:$new_status to (dm:
    "status","feeling like a queen",
    "emoji","üëë",
    "strength",8,
    "length",8,
    "cause","‚ô†Ô∏è Straighten your crown ‚ô†Ô∏è",
    "charm buff",2,
    "intellect buff",1,
    "fitness buff",1
	))(display:"new status")(display:"refresh stats")
}

:: blacked QoS debuff
{
  (set:$new_status to (dm:
    "status","not feeling very queen-like",
    "emoji","üëéüèæ",
    "strength",9,
    "length",12,
    "cause","You've disappointed your Black Kings. Go find some BBC!",
    "charm buff",-2,
    "intellect buff",-1,
    "fitness buff",-1,
    "arousal buff",3,
	))(display:"new status")(display:"refresh stats")
}

:: blacked mood proud
{
  (set:$new_mood to (dm:
    "mood","proud",
    "emoji","üòä",
    "strength",8,
    "length",8,
    "cause",$cause_text,
    "charm buff",3,
    "intellect buff",1,
    "fitness buff",1,
    "effect text","+3 üçÄ / +1 üß† / +1 üí™ from " + $effect_text
	))(display:"new mood")(display:"refresh stats")
}

:: blacked mood ashamed
{
  (set:$new_mood to (dm:
    "mood","ashamed",
    "emoji","üòî",
    "strength",10,
    "length",10,
    "cause",$cause_text,
    "charm buff",-3,
    "intellect buff",-1,
    "fitness buff",-1,
    "arousal buff",-1,
    "effect text","-3 üçÄ / -1 üß† / -1 üí™ from " + $effect_text
	))(display:"new mood")(display:"refresh stats")
}

:: blacked mood satisfied
{
  (set:$new_mood to (dm:
    "mood","satisfied",
    "emoji","üíØ",
    "strength",8,
    "length",8,
    "cause",$cause_text,
    "charm buff",2,
    "intellect buff",0,
    "fitness buff", 0,
    "effect text","+2 üçÄ from " + $effect_text
    ))
  (display:"new mood")(display:"refresh stats")
}

:: blacked mood unsatisfied
{
  (set:$new_mood to (dm:
    "mood","unsatisfied",
    "emoji","üòë",
    "strength",10,
    "length",10,
    "cause",$cause_text,
    "charm buff",-2,
    "intellect buff",0,
    "fitness buff", 0,
    "arousal buff",2,
    "effect text","-2 üçÄ from " + $effect_text
    ))
  (display:"new mood")(display:"refresh stats")
}

:: blacked bbc sex checks
{
  (set:$blacked_stats's "sex as girl" to it + 1)
  (set:$blacked_daily_stats's "sex as girl" to it + 1)
  (if:$stats's "sex as girl" is 1)[(display:"blacked trigger virginity")]
  (set:$curiosity_check to "fucked bbc")(display:"curiosity check")
  (if:($has_ap_mod:"bbc addict mod"))[(display:"action point mod trigger")]
  (if:$mood's "mood" is not "ashamed")[(set:$curiosity_check to "shame-free black sex")(display:"curiosity check")]
  (if:$his_satisfaction is 10)[
    (set:$curiosity_check to "black satisfaction")(display:"curiosity check")
  ]
  (if:(is_bbc_addict:) and $orgasms > 1)[
    (set:$cause_text to "since you orgasmed more than once on a BBC")
    (set:$effect_text to "feeding your BBC addiction")
    (display:"blacked mood proud")
  ]
  (else-if:(is_bbc_addict:) and $orgasms <= 1)[
    (set:$cause_text to "since you slept with a black man")
    (set:$effect_text to "feeding your BBC addiction")
    (display:"blacked mood satisfied")
  ]
  (if:(is_QoS:))[
    (display:"blacked QoS buff")
  ]
  (display:"blacked sex tally")
}

:: serendipity buy porn [around]
{
  (unless: length of (find:_disc where _disc's name is "black cock heaven",...$porn_list) > 0)[(display:"add porn black cock heaven")]
  (if:$day > 30)[
    (unless: length of (find:_disc where _disc's name is "bbc pmvs",...$porn_list) > 0)[(display:"add porn bbc pmvs")]
    (unless: length of (find:_disc where _disc's name is "bbc babecock",...$porn_list) > 0)[(display:"add porn bbc babecock")]
  ]
  (display:_around)
}

:: add porn bbc babecock
{
  (set:$porn_list to it + (a:
  (dm:
    "name", "bbc babecock",
    "type", "BBC",
    "option", "BBC`_`BABECOCK.EXE",
    "description", "This disk is a collection of SIX files featuring both BABES and BBC!",
    "price", 69,
    "img", "scenes/home/porn/BBC/bbc babecock/3.mp4")))
  
  (set:$porn_scenes to it + (a:
  (dm:
    "disk", "bbc babecock",
    "name", "File `#`1",
    "img", "1"),
  (dm:
    "disk", "bbc babecock",
    "name", "File `#`2",
    "img", "2"),
  (dm:
    "disk", "bbc babecock",
    "name", "File `#`3",
    "img", "3"),
  (dm:
    "disk", "bbc babecock",
    "name", "File `#`4",
    "img", "4"),
  (dm:
    "disk", "bbc babecock",
    "name", "File `#`5",
    "img", "5"),
  (dm:
    "disk", "bbc babecock",
    "name", "File `#`6",
    "img", "6")))
}

:: add porn black cock heaven
{
  (set:$porn_list to it + (a:
  (dm:
    "name", "black cock heaven",
    "type", "BBC",
    "option", "BLACK`_`COCK`_`HEAVEN.EXE",
    "description", "A collection of THREE files showing babes being taken to BLACK COCK HEAVEN!!!",
    "price", 69,
    "img", "scenes/home/porn/BBC/black cock heaven/3.mp4")))
  
  (set:$porn_scenes to it + (a:
  (dm:
    "disk", "black cock heaven",
    "name", "File `#`1",
    "img", "1"),
  (dm:
    "disk", "black cock heaven",
    "name", "File `#`2",
    "img", "2"),
  (dm:
    "disk", "black cock heaven",
    "name", "File `#`3",
    "img", "3")))
}

:: add porn bbc pmvs
{
  (set:$porn_list to it + (a:
  (dm:
    "name", "bbc pmvs",
    "type", "BBC",
    "option", "BBC`_`PMVS.EXE",
    "description", "Porn Music Videos (PMVs) are all the hype, especially ones with BBC!! This MEGA collection includes NINE files",
    "price", 99,
    "img", "scenes/home/porn/BBC/bbc pmvs/everything black.mp4")))
  
  (set:$porn_scenes to it + (a:
  (dm:
    "disk", "bbc pmvs",
    "name", "Gimme More",
    "img", "babecock gimme more"),
  (dm:
    "disk", "bbc pmvs",
    "name", "Best Friends",
    "img", "best friends"),
  (dm:
    "disk", "bbc pmvs",
    "name", "More Than Life",
    "img", "more than life"),
  (dm:
    "disk", "bbc pmvs",
    "name", "Everything Black",
    "img", "everything black"),
  (dm:
    "disk", "bbc pmvs",
    "name", "Get Busy",
    "img", "get busy"),
  (dm:
    "disk", "bbc pmvs",
    "name", "Bounce",
    "img", "bounce"),
  (dm:
    "disk", "bbc pmvs",
    "name", "Nasty Girl",
    "img", "nasty girl"),
  (dm:
    "disk", "bbc pmvs",
    "name", "ASAP Ferg",
    "img", "asap ferg"),
  (dm:
    "disk", "bbc pmvs",
    "name", "Blah Blah Blah",
    "img", "blah blah blah")))
}

:: New-U new ID [around]
{
  (display:_around)
  (display:"blacked compatibility check")
}

:: New-U change back [around]
{
  (display:_around)
  (display:"blacked compatibility check")
}

:: New-U roll side effects [around]
{
  (display:"Blacked New-U Side Effect Check")
  (display:_around)
}

:: New-U roll double side effects [around]
{
  (display:"Blacked New-U Side Effect Check")
  (display:_around)
}

:: ensure all coworkers loaded [around]
{
  (set:$coworkers to it - $black_coworkers)
  (display:_around)
}

:: save coworker [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (display:"save npc male")
    (unless:$black_coworkers contains (text:$npc's "id"))[
      (set:$black_coworkers to it + (a:(text:$npc's id)))
    ]
  ](display:_around)
}

:: corpo revenge cleanup [around]
{
  (set:$coworkers to it + $black_coworkers)
  (display:_around)
}

:: npc position inventory
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (unless:(datanames:$npc) contains "dominance")[(set:$npc's "dominance" to 8)]
    ($use_global: "$position_database", "window.GE.position_database", [{
    (set:_filtered_positions to (a:), _positions to (a:), _index to 1)
      (set:_fold to (macro:str-type _type, [
        (set:_char_subtypes to _type of ($character's id of $position_database))
        (out-data:(folded:_dm making _all via _all + (dm-values:_dm's value), (a:), ...(dm-entries:_char_subtypes)))
      ]))

      (set:$position_list to (_fold:"passive"))

      (set: $race_filtered_positions to (find:_position 
            where _position's "tags" contains "black", ...$position_list))

      (set:$athletics_filtered_positions to (find:_position 
            where _position's "athletics" < ($npc's fitness + 2), ...$race_filtered_positions))

      (set:$roughness_filtered_positions to (find:_position 
            where _position's "roughness" < ($npc's dominance + 2) and _position's "roughness" > ($npc's dominance - 2), ...$race_filtered_positions))

    (if:(checkdm:$npc,"ground rules","contains","no bj"))[
    (set:$excluded_positions to
      (find:_position where (a:"blowjob","gag reflex","titfuck","handjob")
      contains _position's "skill"
        , ...($race_filtered_positions)
      )
    )
    (set: $excluded_position_ids to (altered: _position via _position's "id", ...$excluded_positions))
    ](else:)[
      (set:$excluded_positions to (a:))
      (set:$excluded_position_ids to (a:))
    ]
        
    (set:$all_positions to (twisted:...(($athletics_filtered_positions + $roughness_filtered_positions) - $excluded_positions)))
    (set:$sorted_positions to (a:))
    (for: each _filtered_position, ...$all_positions)[

      (unless:$sorted_positions contains _filtered_position)[
      (if:(count:$all_positions,_filtered_position) > 1)[(set:$sorted_positions to (a:_filtered_position) + $sorted_positions)](else:)[(set:$sorted_positions to $sorted_positions + (a:_filtered_position))]]
    ]

    (if:(datanames:$npc) contains "position limit")[(set:$limit to $npc's "position limit")](else:)[(set:$limit to 4)(set:$npc's "position limit" to 4)]

    (set:$npc's "position inventory" to (subarray:$sorted_positions, 1, (min:$sorted_positions's length, $limit)))
      }])
  ](else:)[
    (unless:(datanames:$npc) contains "dominance")[(set:$npc's "dominance" to 8)]
    ($use_global: "$position_database", "window.GE.position_database", [{
    (set:_filtered_positions to (a:), _positions to (a:), _index to 1)
      (set:_fold to (macro:str-type _type, [
        (set:_char_subtypes to _type of ($character's id of $position_database))
        (out-data:(folded:_dm making _all via _all + (dm-values:_dm's value), (a:), ...(dm-entries:_char_subtypes)))
      ]))

    (set:$position_list to (_fold:"passive"))

    (set: $race_filtered_positions to (find:_position 
          where _position's "tags" does not contain "black", ...$position_list))

    (set:$athletics_filtered_positions to (find:_position 
          where _position's "athletics" < ($npc's fitness + 2), ...$race_filtered_positions))

    (set:$roughness_filtered_positions to (find:_position 
          where _position's "roughness" < ($npc's dominance + 2) and _position's "roughness" > ($npc's dominance - 2), ...$race_filtered_positions))

    (if:(checkdm:$npc,"ground rules","contains","no bj"))[
    (set:$excluded_positions to
      (find:_position where (a:"blowjob","gag reflex","titfuck","handjob")
      contains _position's "skill"
        , ...($race_filtered_positions)
      )
    )
    (set: $excluded_position_ids to (altered: _position via _position's "id", ...$excluded_positions))
    ](else:)[
      (set:$excluded_positions to (a:))
      (set:$excluded_position_ids to (a:))
    ]
      
    (set:$all_positions to (twisted:...(($athletics_filtered_positions + $roughness_filtered_positions) - $excluded_positions)))
    (set:$sorted_positions to (a:))
    (for: each _filtered_position, ...$all_positions)[

      (unless:$sorted_positions contains _filtered_position)[
      (if:(count:$all_positions,_filtered_position) > 1)[(set:$sorted_positions to (a:_filtered_position) + $sorted_positions)](else:)[(set:$sorted_positions to $sorted_positions + (a:_filtered_position))]]
    ]

    (if:(datanames:$npc) contains "position limit")[(set:$limit to $npc's "position limit")](else:)[(set:$limit to 4)(set:$npc's "position limit" to 4)]

    (set:$npc's "position inventory" to (subarray:$sorted_positions, 1, (min:$sorted_positions's length, $limit)))
    }])
  ]
}

:: check for new positions
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (set:$found to "false")
    (display:"starting positions")
    ($use_global: "$position_database", "window.GE.position_database", [{
    (set:_filtered_positions to (a:), _positions to (a:), _index to 1)
      (set:_fold to (macro:str-type _type, [
        (set:_char_subtypes to _type of ($character's id of $position_database))
        (out-data:(folded:_dm making _all via _all + (dm-values:_dm's value), (a:), ...(dm-entries:_char_subtypes)))
      ]))
      (set:$positions to (twisted:...(_fold:"active")))

      (set:$race_filtered_positions to (find:_position 
            where _position's "tags" contains "black", ...$positions))
      
      (set:_blowjob_positions to (find:_position 
            where _position's "skill level" <= $blowjob_talent's level and _position's "skill" is "blowjob", ...$race_filtered_positions))
      (set:_handjob_positions to (find:_position 
            where _position's "skill level" <= $handjob_talent's level and _position's "skill" is "handjob", ...$race_filtered_positions))
      (set:_titfuck_positions to (find:_position 
            where _position's "skill level" <= $titfuck_talent's level and _position's "skill" is "titfuck", ...$race_filtered_positions))
      (set:_active_positions to (find:_position 
            where _position's "skill level" <= $dom_sex_talent's level and _position's "skill" is "active sex", ...$race_filtered_positions))
      (set:$owned_positions to (a:))
      (for: each _currently_owned_position, ...$position_inventory's (text:$character's id))[
        (set:$owned_positions to it + (a:_currently_owned_position's id))
      ]
      (for: each _available_position, ...(_blowjob_positions + _handjob_positions + _titfuck_positions + _active_positions))[

        (unless:$owned_positions contains _available_position's id)[
        (set:$found to "true")
        (set:$unlocked_position to _available_position)
        (set:$select to $unlocked_position's id)(display:"get position")]
      ]
    }])
  ](else:)[
    (set:$found to "false")
    (display:"starting positions")
    ($use_global: "$position_database", "window.GE.position_database", [{
    (set:_filtered_positions to (a:), _positions to (a:), _index to 1)
      (set:_fold to (macro:str-type _type, [
        (set:_char_subtypes to _type of ($character's id of $position_database))
        (out-data:(folded:_dm making _all via _all + (dm-values:_dm's value), (a:), ...(dm-entries:_char_subtypes)))
      ]))
      (set:$positions to (twisted:...(_fold:"active")))

      (set:$race_filtered_positions to (find:_position 
            where _position's "tags" does not contain "black", ...$positions))
      
      (set:_blowjob_positions to (find:_position 
            where _position's "skill level" <= $blowjob_talent's level and _position's "skill" is "blowjob", ...$race_filtered_positions))
      (set:_handjob_positions to (find:_position 
            where _position's "skill level" <= $handjob_talent's level and _position's "skill" is "handjob", ...$race_filtered_positions))
      (set:_titfuck_positions to (find:_position 
            where _position's "skill level" <= $titfuck_talent's level and _position's "skill" is "titfuck", ...$race_filtered_positions))
      (set:_active_positions to (find:_position 
            where _position's "skill level" <= $dom_sex_talent's level and _position's "skill" is "active sex", ...$race_filtered_positions))
      (set:$owned_positions to (a:))
      (for: each _currently_owned_position, ...$position_inventory's (text:$character's id))[
        (set:$owned_positions to it + (a:_currently_owned_position's id))
      ]
      (for: each _available_position, ...(_blowjob_positions + _handjob_positions + _titfuck_positions + _active_positions))[

        (unless:$owned_positions contains _available_position's id)[
        (set:$found to "true")
        (set:$unlocked_position to _available_position)
        (set:$select to $unlocked_position's id)(display:"get position")]
      ]
    }])
  ]
}

:: position inventory
{
  (display:"starting positions")
  (set:$unlocked_ids to (a:))
  (for: each _owned_position, ...($position_inventory's (text:$character's id)))[(set:$unlocked_ids to it + (a:_owned_position's id))]
  
  (set:_clean_filters to (dm:
  "type", (dm:"active",false,"passive",false),
  "subtype", (dm:"cowgirl",false,"doggy",false,"missionary",false,"service",false),
  "skill level", (dm:"min",0,"max",10),
  "roughness", (dm:"min",0,"max",10),
  "athletics", (dm:"min",0,"max",10),
  "your pleasure", (dm:"min",0,"max",10),
  "his pleasure", (dm:"min",0,"max",10),
  "his satisfaction", (dm:"min",0,"max",10),
  "partner", (dm:"blacked",false,"normal",false)
  ))

  (set:_filters to _clean_filters)

  (set:_filtered_positions to (a:), _positions to (a:), _index to 1, _filters to _clean_filters)
  (set:_show_position to [{
    (if:_filtered_positions is not an empty)[
      (set:$select to id of _index of _filtered_positions)
      (display:"get position")
    ]
    (rerun:?position_view)
  }])
  (set:_hoverImage to (macro: str-type _img, str-type _imgHover, codehook-type _hook, [
    (out:)[{
      (link-rerun:"<img src='" + _img + "' width=50px height=auto onmouseover=this.src='" + _imgHover + "' onmouseout=this.src='" + _img + "' />")[{
        (display:"click")
        _hook
      }]
    }]
  ]))
  ($use_global: "$position_database", "window.GE.position_database", [{
    (set:_fold to (macro:str-type _type, [
      (set:_char_subtypes to _type of ($character's id of $position_database))
      (out-data:(folded:_dm making _all via _all + (dm-values:_dm's value), (a:), ...(dm-entries:_char_subtypes)))
    ]))
    (set:_positions to (_fold:"active") + (_fold:"passive"))

    (set:_positions to (altered: _position via (cond:
      _position's "tags" contains "black",_position + (dm:"partner","blacked"),
      _position + (dm:"partner","normal")
    ), ..._positions))

    (set:_filtered_positions to _positions)
    _show_position
  }])
  |position_view>[(if:_filtered_positions is not an empty)[(print:$select_position's "video full")]]
  <div style='display:flex;width:100%;gap:1vw'>
    <div style='flex:1'><div class='options'>
      |position_view>[
        (if:_filtered_positions is not an empty)[
          (display:"position stats")
        ](else:)[
          No positions match the current filters.
        ]
      ]
    </div></div>
    <div style='flex:1'>
      <div class='options'>
        |position_view>[<span class='shadow'>Skill used: (color:"bisque")[(print:(upperfirst:$select_position's skill))](print:"
      ")
      Skill level: (color:"bisque")[(print:$select_position's "skill level")](print:"
      ")</span>
          (if:length of _filtered_positions > 1)[
            <div class='borderless'>
              |left>[{
                (_hoverImage: "img/ui/buttons/64button1left.png", "img/ui/buttons/64button2left.png", [{
                  (if:_filtered_positions's length > 1)[
                    (set:_index to (cond:it <= 1, _filtered_positions's length, it - 1))
                    _show_position
                  ]
                }])
              }]
              |right>[{
                (_hoverImage: "img/ui/buttons/64button1right.png", "img/ui/buttons/64button2right.png", [{
                  (if:_filtered_positions's length > 1)[
                    (set:_index to (cond:it >= _filtered_positions's length, 1, it + 1))
                    _show_position
                  ]
                }])
              }]
            </div>
          ]
        ]
        (link-rerun:"Filter")[(css:'max-height:95vh;max-width:95vw')(dialog: bind _response, [{
            (set:$new_filter to (dm-altered:via its value,_filters))
            (set:_slider to (macro:str-type _attribute, [
              (set:_filter to _attribute of $new_filter)
              (set:_id_attribute to (str-replaced:(p-many: whitespace), '-', _attribute))
              (out:)[{
                (print:"<p style='display:grid;gap:1rem;grid-template-columns:repeat(auto-fit,minmax(15rem,1fr))'><span>" + (upperfirst:_attribute) + ": <span id='" + _id_attribute + "-amount'>" + (str:min of _filter) + " - " + (str:max of _filter) + "</span></span><span id='" + _id_attribute + "-slider' style='margin-right:1rem'></span></p><script>
                  let new_filter = $new_filter
                  $('#" + _id_attribute + "-slider').slider({
                    range: true,
                    min: 0,
                    max: 10,
                    values: [new_filter.get('" + _attribute + "').get('min'),new_filter.get('" + _attribute + "').get('max')],
                    slide: function(event, ui) {
                      let new_filter = $new_filter
                      new_filter.get('" + _attribute + "').set('min', ui.values[0])
                      new_filter.get('" + _attribute + "').set('max', ui.values[1])
                      $new_filter = new_filter
                      $('#" + _id_attribute + "-amount').text(ui.values[0] + ' - ' + ui.values[1])
                    }
                  })
                </script>")
              }]
            ]))
            (set:_checkboxes to (macro:str-type _attribute, [
              (out:)[{
                <p style='display:flex;gap:1rem'>
                  <span style='flex:1'>(upperfirst:_attribute):</span>
                  <span style='display:grid;gap:1rem;grid-template-columns:repeat(auto-fill,minmax(6.2em,1fr));flex:4'>
                    (css:'display:contents')+(for:each _value, ...(dm-names:_attribute of $new_filter))[
                      <span>(checkbox:2bind _value of _attribute of $new_filter, (upperfirst:_value))</span>
                    ]
                  </span>
                </p>
              }]
            ]))
            <div style='max-height:calc(95vh - 5em);width:50rem;max-width:calc(95vw - 4em)' data-simplebar>
              (_checkboxes:"partner")
              (_checkboxes:"type")
              (_checkboxes:"subtype")
              (_slider:"skill level")
              (_slider:"athletics")
              (_slider:"your pleasure")
              (_slider:"his pleasure")
              (_slider:"his satisfaction")
              (_slider:"roughness")
            </div>
          }], "Apply", "Cancel", "Clear")(if:_response is "Apply")[(set:_filters to $new_filter)(rerun:?filter)](else-if:_response is "Clear")[(set:_filters to _clean_filters)(rerun:?filter)]]
        (link:"Back")[(display:"go back")]
      </div>
      |filter>[
        (set:_number_filters to (find:_entry where _entry's value contains "min", ...(dm-entries:_filters)))
        (set:_partner_entries to (dm-entries:partner of _filters))
        (set:_type_entries to (dm-entries:type of _filters))
        (set:_subtype_entries to (dm-entries:subtype of _filters))

        (set:_filtered_positions to (find:_position 
          where (all-pass: _entry where _entry's name of _position >= min of _entry's value and <= max of _entry's value, ..._number_filters)
            and ((none-pass: where its value, ..._type_entries) or (some-pass: _entry where _entry's value and _position's type is _entry's name, ..._type_entries))
            and ((none-pass: where its value, ..._subtype_entries) or (some-pass: _entry where _entry's value and _position's subtype is _entry's name, ..._subtype_entries))
            and ((none-pass: where its value, ..._partner_entries) or (some-pass: _entry where _entry's value and _position's partner is _entry's name, ..._partner_entries))
          , ..._positions))

        (if:(some-pass:where its id is $select, ..._filtered_positions))[
          (set:_filtered_positions to (rotated-to: where its id is $select, ..._filtered_positions))
        ]
        (set:_index to 1)
        _show_position
        (set:_checkboxes_display to (macro:str-type _desc, array-type _entries, [
          (out:)[{
            (if:(some-pass: where its value, ..._entries))[
              <div>_desc: (joined:", ", ...(altered: via (upperfirst:its name), ...(find:where its value, ..._entries)))</div>
            ]
          }]
        ]))
        (_checkboxes_display:"Partner", _partner_entries)
        (_checkboxes_display:"Type", _type_entries)
        (_checkboxes_display:"Subtype", _subtype_entries)
        (for:each _entry, ...(sorted:via (str-replaced:"y","b",its name), ...(find:_a where min of value of _a > 1 or max of value of _a < 10,..._number_filters)))[
          <div>(upperfirst:_entry's name): (print:min of _entry's value) - (print:max of _entry's value)</div>
        ]
      ]
    </div>
  </div>
}

:: sex transactional bed position options [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    []<position_options|
    (live:0.1s)[(display:"starting positions")(set:$sex_loop_continue to "true")(if:$option is "breeder check")[(set:$next to "sex transactional breeder check")(display:"change screen")](else:)[{(replace:?options)[{<div class='options'>
    (set:$select_his_position to 0)
    (if:(datanames:$npc) contains "position inventory")[(if:($npc's "position inventory")'s length > 1)[(set:$select_his_position to (twirl:...$npc's "position inventory"))]]

    (set: $race_filtered_positions to (find:_position 
            where _position's "tags" contains "black", ...$position_inventory's (text: $character's id)))

    (set: $your_positions to (twisted: ...($race_filtered_positions - $excluded_positions)))

    (set: $select_your_position_1 to $your_positions's 1st)
    (set: $select_your_position_2 to $your_positions's 2nd)
    (set: $select_your_position_3 to $your_positions's 3rd)

    (set: $stamina_cost_1 to (round:(min:(max:(ceil:(($select_your_position_1's athletics)/2) - (((get_fitness:))/3)),1),5)))
    (set: $stamina_cost_2 to (round:(min:(max:(ceil:(($select_your_position_2's athletics)/2) - (((get_fitness:))/3)),1),5)))
    (set: $stamina_cost_3 to (round:(min:(max:(ceil:(($select_your_position_3's athletics)/2) - (((get_fitness:))/3)),1),5)))

    (set: $stamina_cost_text_1 to (str-repeated: $stamina_cost_1, "‚ö°") + " ")
    (set: $stamina_cost_text_2 to (str-repeated: $stamina_cost_2, "‚ö°") + " ")
    (set: $stamina_cost_text_3 to (str-repeated: $stamina_cost_3, "‚ö°") + " ")

    (print:" ")($show_tooltip:[(link:(upperfirst:$select_his_position's name))[(display:"sex transactional bed position select his")]],[*(print:1st of $select_his_position's flavors)*(nl:2)(color:"bisque")[Sex skill used: (print:(upperfirst:$select_his_position's "skill"))(nl:1)Difficulty: (print:$select_his_position's "skill level")](nl:1)Position: (print:(upperfirst:$select_his_position's position))(nl:1)üí¶ Your pleasure: (print:$select_his_position's "your pleasure")(nl:1)üçæ His pleasure: (print:$select_his_position's "his pleasure")(nl:1)üòã His satisfaction: (print:$select_his_position's "his satisfaction")(nl:1)üóø Roughness: (print:$select_his_position's "his satisfaction")])($show_tooltip:[(link:(upperfirst:$select_your_position_1's name + $stamina_cost_text_1))[(set:$position to 1)(display:"sex transactional bed position select yours")]],[*(print:1st of $select_your_position_1's flavors)*(nl:1)(color:"bisque")[Sex skill used: (print:(upperfirst:$select_your_position_1's "skill"))(nl:1)Difficulty: (print:$select_your_position_1's "skill level")](nl:1)Position: (print:(upperfirst:$select_your_position_1's position))(nl:1)üí¶ Your pleasure: (print:$select_your_position_1's "your pleasure")(nl:1)üçæ His pleasure: (print:$select_your_position_1's "his pleasure")(nl:1)üòã His satisfaction: (print:$select_your_position_1's "his satisfaction")(nl:1)üóø Roughness: (print:$select_your_position_1's "his satisfaction")])($show_tooltip:[(link:(upperfirst:$select_your_position_2's name + $stamina_cost_text_2))[(set:$position to 2)(display:"sex transactional bed position select yours")]],[*(print:1st of $select_your_position_2's flavors)*(nl:1)(color:"bisque")[Sex skill used: (print:(upperfirst:$select_your_position_2's "skill"))(nl:1)Difficulty: (print:$select_your_position_2's "skill level")](nl:1)Position: (print:(upperfirst:$select_your_position_2's position))(nl:1)üí¶ Your pleasure: (print:$select_your_position_2's "your pleasure")(nl:1)üçæ His pleasure: (print:$select_your_position_2's "his pleasure")(nl:1)üòã His satisfaction: (print:$select_your_position_2's "his satisfaction")(nl:1)üóø Roughness: (print:$select_your_position_2's "his satisfaction")])($show_tooltip:[(link:(upperfirst:$select_your_position_3's name + $stamina_cost_text_3))[(set:$position to 3)(display:"sex transactional bed position select yours")]],[*(print:1st of $select_your_position_3's flavors)*(nl:1)(color:"bisque")[Sex skill used: (print:(upperfirst:$select_your_position_3's "skill"))(nl:1)Difficulty: (print:$select_your_position_3's "skill level")](nl:1)Position: (print:(upperfirst:$select_your_position_3's position))(nl:1)üí¶ Your pleasure: (print:$select_your_position_3's "your pleasure")(nl:1)üçæ His pleasure: (print:$select_your_position_3's "his pleasure")(nl:1)üòã His satisfaction: (print:$select_your_position_3's "his satisfaction")(nl:1)üóø Roughness: (print:$select_your_position_3's "his satisfaction")])}]</div>}](stop:)]
  ](else:)[
    []<position_options|
    (live:0.1s)[(display:"starting positions")(set:$sex_loop_continue to "true")(if:$option is "breeder check")[(set:$next to "sex transactional breeder check")(display:"change screen")](else:)[{(replace:?options)[{<div class='options'>
    (set:$select_his_position to 0)
    (if:(datanames:$npc) contains "position inventory")[(if:($npc's "position inventory")'s length > 1)[(set:$select_his_position to (twirl:...$npc's "position inventory"))]]

    (set: $race_filtered_positions to (find:_position 
            where _position's "tags" does not contain "black", ...$position_inventory's (text: $character's id)))

    (set: $your_positions to (twisted: ...($race_filtered_positions - $excluded_positions)))

    (set: $select_your_position_1 to $your_positions's 1st)
    (set: $select_your_position_2 to $your_positions's 2nd)
    (set: $select_your_position_3 to $your_positions's 3rd)

    (set: $stamina_cost_1 to (round:(min:(max:(ceil:(($select_your_position_1's athletics)/2) - (((get_fitness:))/3)),1),5)))
    (set: $stamina_cost_2 to (round:(min:(max:(ceil:(($select_your_position_2's athletics)/2) - (((get_fitness:))/3)),1),5)))
    (set: $stamina_cost_3 to (round:(min:(max:(ceil:(($select_your_position_3's athletics)/2) - (((get_fitness:))/3)),1),5)))

    (set: $stamina_cost_text_1 to (str-repeated: $stamina_cost_1, "‚ö°") + " ")
    (set: $stamina_cost_text_2 to (str-repeated: $stamina_cost_2, "‚ö°") + " ")
    (set: $stamina_cost_text_3 to (str-repeated: $stamina_cost_3, "‚ö°") + " ")

    (print:" ")($show_tooltip:[(link:(upperfirst:$select_his_position's name))[(display:"sex transactional bed position select his")]],[*(print:1st of $select_his_position's flavors)*(nl:2)(color:"bisque")[Sex skill used: (print:(upperfirst:$select_his_position's "skill"))(nl:1)Difficulty: (print:$select_his_position's "skill level")](nl:1)Position: (print:(upperfirst:$select_his_position's position))(nl:1)üí¶ Your pleasure: (print:$select_his_position's "your pleasure")(nl:1)üçæ His pleasure: (print:$select_his_position's "his pleasure")(nl:1)üòã His satisfaction: (print:$select_his_position's "his satisfaction")(nl:1)üóø Roughness: (print:$select_his_position's "his satisfaction")])($show_tooltip:[(link:(upperfirst:$select_your_position_1's name + $stamina_cost_text_1))[(set:$position to 1)(display:"sex transactional bed position select yours")]],[*(print:1st of $select_your_position_1's flavors)*(nl:1)(color:"bisque")[Sex skill used: (print:(upperfirst:$select_your_position_1's "skill"))(nl:1)Difficulty: (print:$select_your_position_1's "skill level")](nl:1)Position: (print:(upperfirst:$select_your_position_1's position))(nl:1)üí¶ Your pleasure: (print:$select_your_position_1's "your pleasure")(nl:1)üçæ His pleasure: (print:$select_your_position_1's "his pleasure")(nl:1)üòã His satisfaction: (print:$select_your_position_1's "his satisfaction")(nl:1)üóø Roughness: (print:$select_your_position_1's "his satisfaction")])($show_tooltip:[(link:(upperfirst:$select_your_position_2's name + $stamina_cost_text_2))[(set:$position to 2)(display:"sex transactional bed position select yours")]],[*(print:1st of $select_your_position_2's flavors)*(nl:1)(color:"bisque")[Sex skill used: (print:(upperfirst:$select_your_position_2's "skill"))(nl:1)Difficulty: (print:$select_your_position_2's "skill level")](nl:1)Position: (print:(upperfirst:$select_your_position_2's position))(nl:1)üí¶ Your pleasure: (print:$select_your_position_2's "your pleasure")(nl:1)üçæ His pleasure: (print:$select_your_position_2's "his pleasure")(nl:1)üòã His satisfaction: (print:$select_your_position_2's "his satisfaction")(nl:1)üóø Roughness: (print:$select_your_position_2's "his satisfaction")])($show_tooltip:[(link:(upperfirst:$select_your_position_3's name + $stamina_cost_text_3))[(set:$position to 3)(display:"sex transactional bed position select yours")]],[*(print:1st of $select_your_position_3's flavors)*(nl:1)(color:"bisque")[Sex skill used: (print:(upperfirst:$select_your_position_3's "skill"))(nl:1)Difficulty: (print:$select_your_position_3's "skill level")](nl:1)Position: (print:(upperfirst:$select_your_position_3's position))(nl:1)üí¶ Your pleasure: (print:$select_your_position_3's "your pleasure")(nl:1)üçæ His pleasure: (print:$select_your_position_3's "his pleasure")(nl:1)üòã His satisfaction: (print:$select_your_position_3's "his satisfaction")(nl:1)üóø Roughness: (print:$select_your_position_3's "his satisfaction")])}]</div>}](stop:)]
    ]
  }

:: sex transactional initialize [around]
{
  (display:_around)
  (if:(checkdm:$npc, "race", "is", "black"))[
    (set:$minigame's "cock type" to "bbc")
  ]
}

:: sex doggy transactional [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (display:"sex doggy transactional " + $character's "id")

    (set:$doggy_pic to "<img class='greyborder' 
    src='img/scenes/characters/" + $character's "id" + "/sex/doggy/bbc/transactional insert " + (text:(twist:1,4)) + ".jpg' width=100% height=auto>")
    (set:$doggy_moan_pic to "<img class='greyborder' 
    src='img/scenes/characters/" + $character's "id" + "/sex/doggy/bbc/moan " + (text:(twist:1,4)) + ".jpg' width=100% height=auto>")

    (set:$backdrop_img to "scenes/characters/" + $img + ".mp4")
    (set:$doggy_img to "scenes/characters/" + $img + ".mp4")
    (set:$img to "<video src='img/scenes/characters/" + $img + ".mp4' autoplay='' loop='' muted='' playsinline/>")
    (if:(twist:1,4) is 1)[(set:$sex_loop to (twirl:"sex loop","sex loop 2"))(set:$doggy_loop to (twirl:"sex loop","sex loop 2"))](else:)[(display:"doggy sounds")]
    (set:$doggy_text to $text)
  ](else:)[(display:_around)]
}

:: blowjob transactional initialize [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (set:$scene_type to "blowjob")
    (if:(datanames:$blowjob) contains "interrupt chance")[(set:$interrupt_chance to $blowjob's "interrupt chance")(set:$interrupt_roll to $blowjob's "interrupt roll")](else:)[(set:$interrupt_chance to 0)(set:$interrupt_roll to 1)]
    (set:$satisfaction to 0)
    (display:"sex sound variants")
    
    (if:(twist:1,4) is 1)[
      (if:($character's "race" is "black"))[(set:$img to "scenes/generic/sex/bj/bbc/dark " + (text:(twist:1,4)) + ".mp4")]
      (else-if:(twist:1,3) is 1)[(set:$img to "scenes/generic/sex/bj/bbc/clothed " + (text:(twist:1,3)) + ".mp4")]
      (else:)[(set:$img to "scenes/generic/sex/bj/bbc/light " + (text:(twist:1,6)) + ".mp4")]
      ](else:)[(display:"blowjob transactional initialize " + (text:$character's "id"))]

    (replace:?portrait)[($pic:"characters/bj/bbc/" + (text:$character's "id") + ".jpg")]
    <!--(replace:?portrait)[(print:"<img class='border' src='img/characters/bj/bbc/" + (text:$character's "id") + ".jpg' width='100%' height=auto>")]-->
    (set:$stats's "blowjobs given" to it + 1)
    (set:$blacked_stats's "blowjobs given" to it + 1)
    (set:$blacked_daily_stats's "blowjobs given" to it + 1)

    (if:(datanames:$npc) contains "tags")[(set:$tags to $npc's tags)](else:)[(set:$tags to (a:))]

    (set:$minigame to (dm:
      "difficulty",(twist:5,10),
      "babe type","clothed",
      "cock type","bbc",
      "masculinity level",65,
      "reason 1",(twirl:"You looked cute giving blowjobs to black men.","Did that BBC even fit in your mouth?","Didn't you like sucking that big, black cock?"),
      "reason 2","How did you like sucking that black dick?",
      "reason 3","You looked so cute and desperate, sucking that black guy off.",
      "afterwards","blowjob transactional finish"))
      
    (if:(datanames:$npc) contains "tags")[
    (set:$minigame's "reason 1" to (twirl:"You had your lips wrapped around " + $npc's "name" + "'s black cock like you were gonna suck out his soul, haha.","You have the makings of a fine little black cock whore, I'm sure " + $npc's "name" + " would agree.","If only you could've seen yourself, lips wrapped around that " + $npc's "unfamiliar name" + "'s " + $npc's "cockdesc" + " cock."))
    (set:$minigame's "reason 2" to (twirl:"Did you actually *enjoy* sucking " + $npc's "name" + "'s big black cock?","Did you like the feeling of pleasing " + $npc's "name" + ", using just your mouth?","Did you feel degraded, inferior, with your lips wrapped around that " + $npc's "unfamiliar name" + "'s " + $npc's "cockdesc" + " cock?"))
    (if:$npc's age > 39)[(set:$minigame's "reason 3" to (twirl:"That guy you sucked off... he was old enough to be your father.","Have a thing for blowing old black guys, eh?","That guy you just blew was old enough to be your dad. How does that make you feel?"))]
    (if:$npc's tags contains "fuckboy")[(set:$minigame's "reason 3" to (twirl:"That black guy just saw you as a warm pair of lips. He didn't care about you.","That guy knows he's better than you.","You really sucked that black guy off.","I can't believe you blew a total fuckboy like that. You're really hopeless!"))]
    (if:$npc's tags contains "chad")[(set:$minigame's "reason 2" to (twirl:"That black man is superior to you in every way. Of course you sucked his cock.","Of course you sucked off that black alpha - you're his inferior, by far."))]
    ]

    (set:$quicktime_params to (dm:
    "difficulty","medium",
    "type","bj",
    "victory","He loves how eager you are.",
    "defeat","*It's just so big...*",
    "skill check","bj",
    "skill check difficulty",50,
    "points to win",45,
    "points",15,
    "sequence",(a:"up","down","up","down","up","up","none","down","up","down","left","right"),
    "quicktime timer",1,
    "result passage","blowjob transactional result",
    "backdrop",$img
    ))
    (display:"quicktime bj sequence randomize")
    (set:$img to "<video src='img/"+ $img + "' autoplay='' loop='' muted='' playsinline/>")
    (display:"blowjob sounds")

    (set:$next to "quicktime initialize")(display:"change screen")</div>
  ](else:)[(display:_around)]
}

:: sex transactional blowjob [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (if:(twist:1,4) is 1)[
      (if:($character's "race" is "black"))[(set:$img to "scenes/generic/sex/bj/bbc/dark " + (text:(twist:1,4)) + ".mp4")]
      (else-if:(twist:1,3) is 1)[(set:$img to "scenes/generic/sex/bj/bbc/clothed " + (text:(twist:1,3)) + ".mp4")]
      (else:)[(set:$img to "scenes/generic/sex/bj/bbc/light " + (text:(twist:1,6)) + ".mp4")]
    ](else:)[(display:"sex transactional blowjob " + $character's "id")]
    
    (replace:?portrait)[($pic:"characters/bj/bbc/" + (text:$character's "id") + ".jpg")]
    <!--(replace:?portrait)[(print:"<img class='border' src='img/characters/bj/bbc/" + (text:$character's "id") + ".jpg' width='100%' height=auto>")]-->
    (set:$stats's "blowjobs given" to it + 1)
    (set:$blacked_stats's "blowjobs given" to it + 1)
    (set:$blacked_daily_stats's "blowjobs given" to it + 1)

    (if:(datanames:$npc) contains "tags")[(set:$tags to $npc's tags)](else:)[(set:$tags to (a:))]
    (display:"npc describe cock")(set:(either:"reason 1","reason 2","reason 3") of $minigame to "The way you got down on your knees and just sucked his " + (text:$cock) + "...")(set:$minigame's "masculinity level" to (max:60,$minigame's "masculinity level" - 5))
      
    (if:(datanames:$npc) contains "tags")[

    (set:$minigame's "reason 1" to (either:"You had your lips wrapped around " + $npc's "name" + "'s cock like you were gonna suck out his soul, haha.","You have the makings of a fine little cock-sucking slut, I'm sure " + $npc's "name" + " would agree.","If only you could've seen yourself, lips wrapped around that " + $npc's "unfamiliar name" + "'s " + $npc's "cockdesc" + " cock."))
    (set:$minigame's "reason 2" to (either:"Did you actually *enjoy* sucking " + $npc's "name" + "'s cock?","Did you like the feeling of pleasing " + $npc's "name" + ", using just your mouth?","Did you feel degraded, inferior, with your lips wrapped around that " + $npc's "unfamiliar name" + "'s " + $npc's "cockdesc" + " cock?"))
    (if:$npc's age > 39)[(set:$minigame's "reason 3" to (either:"That guy you sucked off... he was old enough to be your father.","Have a thing for blowing old guys, eh?","That guy you just blew was old enough to be your dad. How does that make you feel?"))]
    (if:$npc's tags contains "fuckboy")[(set:$minigame's "reason 3" to (either:"That guy just saw you as a warm pair of lips. He didn't care about you.","That guy knows he's better than you.","You really sucked that fuckboy off.","I can't believe you blew a total fuckboy like that. You're really hopeless!"))]
    (if:$npc's tags contains "chad")[(set:$minigame's "reason 2" to (either:"That guy is superior to you in every way. Of course you sucked his cock.","Of course you sucked off that total chad - you're his inferior, by far."))]

    ]

    (set:$quicktime_params to (dm:
    "difficulty","medium",
    "type","bj",
    "real time his pleasure","enabled",
    "victory","He loves how eager you are.",
    "defeat","*It's just so big...*",
    "skill check","bj",
    "skill check difficulty",50,
    "points to win",45,
    "points",15,
    "sequence",(a:"up","down","up","down","up","up","none","down","up","down","left","right"),
    "quicktime timer",1,
    "result passage","sex transactional blowjob result",
    "backdrop",$img
    ))
    (display:"quicktime bj sequence randomize")
    (set:$img to "<video src='img/"+ $img + "' autoplay='' loop='' muted='' playsinline/>")
    (display:"blowjob sounds")

    (set:$next to "quicktime initialize")(display:"change screen")(set:$character's "status" to "bj/bbc")(set:$outfit_button to "dont show")(display:"outfit button")(display:"refresh portrait")
    </div>
  ](else:)[(display:_around)]
}

:: blowjob transactional cum [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (replace:?right_options)[](if:(twist:1,2) is 1)[(print:"<video disableRemotePlayback src='img/scenes/generic/sex/pre/bbc/jerking.mp4' autoplay='' loop='' muted='' playsinline/>")](else:)[(print:$img)]
    (if:(win:))[
      <mark>His satisfaction +1!</mark>(set:$satisfaction to $satisfaction + 1)
    ]
    (if:(twist:1,2) is 1)[
      (print:(upperfirst:$npc's "sex name")) (twirl:"groans, he's gonna cum!","gives a loud moan.","Moans loudly. He's about to blow his load!","groans heavily, and his cock twitches. He's about to cum.")
    ]
    (else:)[
      (print:(upperfirst:$npc's "sex name"))'s (twirl:"cock twitches in your mouth","cock twitches","cock starts to throb in your mouth"). (twirl:"He's gonna cum.","He's gonna blow!")
    ]
    <div class='options'>(link:"On my face!")[
      (set:$choice to "face")(set:$next to "blowjob transactional cum choice")(display:"change screen")
      ](link:"In my mouth!")[
        (set:$choice to "mouth")(set:$next to "blowjob transactional cum choice")(display:"change screen")
        ]
    </div>
  ](else:)[(display:_around)]
}

:: sex transactional kiss [around]
{
  (display:_around)
  (if:(checkdm:$npc, "race", "is", "black"))[
    ($char_passage:"sex transactional kiss",[
      (set:$kiss_variant to (cond:
      $character's "id" is "alina", "kiss " + (text:(twist:1,5)),
      $character's "id" is "ella", "kiss " + (text:(twist:1,3)),
      $character's "id" is "jade", "kiss " + (text:(twist:1,2)),
      $character's "id" is "jia", "kiss " + (text:(twist:1,2)),
      $character's "id" is "lana", "kiss " + (text:(twist:1,2)),
      $character's "id" is "liya", "kiss " + (text:(twist:1,3)),
      $character's "id" is "mia", "kiss " + (text:(twist:1,2)),
      $character's "id" is "rae", "kiss",
      $character's "id" is "scarlit", "kiss " + (text:(twist:1,4)),
      "kiss"
      )
    )],[])
    (if:$kiss_variant is 0)[
      (set:$kiss_variant to "kiss")
    ]
    (replace:?image)[($vid:"scenes/characters/" + $character's id + "/foreplay/bbc/" + $kiss_variant + ".mp4")]
  ]
}

:: sex transactional grope [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    ($char_passage:"sex transactional grope",[
      (set:$grope to $character's "id" of (dm:
      "alina",(twirl:"ass","tits"),
      "ella",(twirl:"ass","tits"),
      "jade",(twirl:"ass","tits"),
      "jia","tits",
      "lana",(twirl:"ass","tits"),
      "liya",(twirl:"ass","tits"),
      "mia","tits",
      "rae",(twirl:"ass","tits"),
      "scarlit",(twirl:"ass","tits")
      ))

      (set:$grope_img to (cond:
      $character's "id" is "ella" and $grope is "tits", "tits " + (text:(twist:1,3)),
      $character's "id" is "jade" and $grope is "tits", "tits " + (text:(twist:1,2)),
      $character's "id" is "liya" and $grope is "tits", "tits " + (text:(twist:1,2)),
      $character's "id" is "scarlit" and $grope is "tits", "tits " + (text:(twist:1,2)),
      $grope))],[]) 
  (replace:?options)[
  (set:$case to "upper")(display:"npc pronoun") starts (twirl:"groping","fondling") your 
  (if:$grope is "tits")[
    (display:"describe breasts")(display:"describe breasts"){
      (set:(twirl:"reason 1","reason 2","reason 3") of $minigame to "Do you like it when black men grope your " + (text:$breasts) + "?")
      (set:$minigame's "masculinity level" to (max:60,$minigame's "masculinity level" - 5))}$breasts.
  ](else:)[
    {(display:"describe butt")$butt.(display:"describe butt")
    (set:(twirl:"reason 1","reason 2","reason 3") of $minigame to "Do you like it when black men grope your " + (text:$butt) + "?")
    (set:$minigame's "masculinity level" to (max:60,$minigame's "masculinity level" - 5))}
  ]
  <div class='options'>(link:"Talk dirty")[(set:$option to "talk dirty")(display:"sex transactional grope react")](link:(twirl:"Just moan","Just endure it","Smile","Bite your lip"))[(set:$option to "moan")(display:"sex transactional grope react")]</div>
  ]](else:)[(display:_around)]
}

:: sex transactional grope react [around]
{
  (display:_around)
  (if:(checkdm:$npc, "race", "is", "black"))[
    (if:$grope_img is 0)[
      (set:$grope_img to $grope)
    ]
    (replace:?image)[($vid:"scenes/characters/" + $character's "id" + "/foreplay/bbc/grope " + $grope_img + ".mp4")]
  ]
}

:: sex transactional option links [around]
{
  (display:_around)
  (if:(checkdm:$npc, "race", "is", "black"))[
    (if:$npc's "cock" is "in you")[
      <!--(replace:?right_options)[(print: "<img class='greyborder' src='img/characters/sex/bbc/doggy/" +  $character's "id" + ".jpg' width='100%' height=auto>")] -->
      (replace:?right_options)[($pic:"characters/sex/bbc/doggy/" +  $character's "id" + ".jpg")]
      ]
  ]
}

:: sex transactional insert check [around]
{
  (display:_around)
  (if:(checkdm:$npc, "race", "is", "black"))[
    (replace:?image)[($pic:"characters/sex/insert/bbc/" +  $character's "id" + ".jpg")]
    (replace:?right_options)[($pic:"characters/sex/doggy/bbc/" + $character's "id" + ".jpg")]
  ]
}

:: sex transactional pre result [around]
{
  (display:_around)
  (if:(checkdm:$npc, "race", "is", "black"))[
    (unless:$minigame_played is "true")[
        (replace:?right_options)[($pic:"characters/sex/doggy/bbc/" +  $character's "id" + ".jpg")]
    ]
  ]
}

:: sex creampie image [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (set:$generic_creampie_variant to (cond:
      $character's "id" is "ella",1,
      $character's "id" is "jade",1,
      (twist:1,4)))

    (if:(exists:"sex creampie image " + $character's "id"))[
      (display:"sex creampie image " + $character's "id")
    ]

    (if:$generic_creampie_variant is 1)[
      (if:$character's "race" is "black")[
        (if:$position is "riding")[(set:$img to "/generic/sex/cum/creampie/c/bbc/riding 1")]
        (else:)[(set:$img to "/generic/sex/cum/creampie/c/bbc/missionary " + (text:(twist:1,4)))]
      ]
      (else:)[
        (if:$position is "riding")[(set:$img to "/generic/sex/cum/creampie/w/bbc/riding " + (text:(twist:1,7)))]
        (else-if:$position is "missionary")[(set:$img to "/generic/sex/cum/creampie/w/bbc/missionary " + (text:(twist:1,10)))]
        (else:)[(set:$img to "/generic/sex/cum/creampie/w/bbc/doggy " + (text:(twist:1,10)))]
      ]
    ](else:)[
      ($char_passage:"sex creampie image",[(set:$img to (cond:
        $character's "id" is "alina", "/characters/alina/cum/bbc/creampie/" + (text:(twist:1,2)),
        $character's "id" is "jia","/characters/jia/cum/bbc/creampie/" + (text:(twist:1,2)),
        $character's "id" is "lana","/characters/lana/cum/bbc/creampie/" + (text:(twist:1,2)),
        $character's "id" is "liya","/characters/liya/cum/bbc/creampie/" + (text:(twist:1,2)),
        $character's "id" is "mia","/characters/mia/cum/bbc/creampie/" + (text:(twist:1,5)),
        $character's "id" is "rae","/characters/rae/cum/bbc/creampie/" + (text:(twist:1,4)),
        $character's "id" is "scarlit","/characters/scarlit/cum/bbc/creampie/1",
        "/generic/sex/cum/creampie/w/bbc/doggy 1"
      ))
    ],[])
    ]
    (set:$creampie_image to "img/scenes"+ $img + ".mp4")
    (set:$img to "<video src='img/scenes"+ $img + ".mp4' autoplay='' loop='' muted='' playsinline/>")
  ](else:)[(display:_around)]
}

:: sex cum on face [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (display:"change pov")
    (if:$pov is "1st")[
      (set:$cum_face to (dm:))
      (set:$img to "/generic/sex/cum/bbc facial " + (text:(twist:1,5)))
    ]
    (else:)[(display:"sex cum on face " + $character's "id")]

    (set:$text to $img of ($cum_face + (dm:
      "/generic/sex/cum/bbc facial 1",(a:"ooze","face","eyes","clothes"),
      "/generic/sex/cum/bbc facial 2",(a:"drip","face",(twirl:"mouth","tongue")),
      "/generic/sex/cum/bbc facial 3",(a:"spray","face","eyes","tits"),
      "/generic/sex/cum/bbc facial 4",(a:"spurt","face",(twirl:"eyes","nose"),"cumdump"),
      "/generic/sex/cum/bbc facial 5",(a:"ooze","face","chin","tits"))))

    (set:$img to "<video disableRemotePlayback src='img/scenes"+ $img + ".mp4' autoplay='' loop='' muted='' playsinline/>")
    (set:$cum_text to $text)
  ](else:)[(display:_around)]
}

:: sex cum in mouth [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (if:(datanames:$npc) contains "ballsize")[(if:$npc's "ballsize" > (twist:8,10))[(set:$load to "big")]]
    (else:)[(set:$load to "normal")]

    (if:$load is "big")[
      (set:$text to (a:"big load"))
      (if:$character's "race" is "black")[(set:$img to "/generic/sex/cum/mouth/bbc/c/" + (text:(twirl:2,4,5)))
        (set:$text to $text + $img of (dm:
        "/generic/sex/cum/mouth/bbc/c/2",(a:"lips","face"),
        "/generic/sex/cum/mouth/bbc/c/4",(a:"tongue","face"),
        "/generic/sex/cum/mouth/bbc/c/5",(a:"tongue","chin"),
        ))
        (set:$rhythm to $img of (dm:
        "/generic/sex/cum/mouth/bbc/c/2",500,
        "/generic/sex/cum/mouth/bbc/c/4",500,
        "/generic/sex/cum/mouth/bbc/c/5",500,
        ))
      ](else:)[
        (set:$img to "/generic/sex/cum/mouth/bbc/w/" + (text:(twirl:4,5,7,8,11,12)))
        (set:$text to $text + $img of (dm:
        "/generic/sex/cum/mouth/bbc/w/4",(a:"face","huge"),
        "/generic/sex/cum/mouth/bbc/w/5",(a:"mouth","tongue"),
        "/generic/sex/cum/mouth/bbc/w/7",(a:"tongue","chin"),
        "/generic/sex/cum/mouth/bbc/w/8",(a:"tongue","chin"),
        "/generic/sex/cum/mouth/bbc/w/11",(a:"lips","face","tongue","huge"),
        "/generic/sex/cum/mouth/bbc/w/12",(a:"tongue","lips","nose","chin"),
        ))

        (set:$rhythm to $img of (dm:
        "/generic/sex/cum/mouth/bbc/w/4",500,
        "/generic/sex/cum/mouth/bbc/w/5",500,
        "/generic/sex/cum/mouth/bbc/w/7",500,
        "/generic/sex/cum/mouth/bbc/w/8",500,
        "/generic/sex/cum/mouth/bbc/w/11",500,
        "/generic/sex/cum/mouth/bbc/w/12",500,
        ))
      ]
      (set:$backdrop to "scenes/" + $img + ".mp4")
      (set:$sex_loop to "big load " + (text:(twist:1,6)))
      (set:$se to "big load " + (text:(twist:1,6)))
    ](else:)[
      (if:(twist:1,4) is 1)[(set:$cum_mouth_generic to 1)]

      (display:"sex cum in mouth load " + $character's "id")

      (if:$cum_mouth_generic is 1)[
        (if:$character's "race" is "black")[
          (set:$img to "/generic/sex/cum/mouth/bbc/c/" + (text:(twirl:1,3)))
          (set:$text to $img of (dm:
          "/generic/sex/cum/mouth/bbc/c/1",(a:"internal","kneeling","in mouth"),
          "/generic/sex/cum/mouth/bbc/c/3",(a:"internal","kneeling","in mouth"),
          ))
        ]
        (else:)[
          (set:$img to "/generic/sex/cum/mouth/bbc/w/" + (text:(twirl:1,2,3,6,9,10)))
          (set:$text to $img of (dm:	
          "/generic/sex/cum/mouth/bbc/w/1",(a:"internal","in mouth","kneeling"),
          "/generic/sex/cum/mouth/bbc/w/2",(a:"internal","in mouth","kneeling"),
          "/generic/sex/cum/mouth/bbc/w/3",(a:"internal","lying","in mouth","direct"),
          "/generic/sex/cum/mouth/bbc/w/6",(a:"internal","messy","kneeling"),
          "/generic/sex/cum/mouth/bbc/w/9",(a:"internal","in mouth","spit","kneeling"),
          "/generic/sex/cum/mouth/bbc/w/10",(a:"internal","on tongue","kneeling"),
          "/generic/sex/cum/mouth/bbc/c/1",(a:"internal","kneeling","in mouth")))
        ]
      ]
    ]
    (set:$cum_text to $text)
    (set:$img to "<video disableRemotePlayback src='img/scenes"+ $img + ".mp4' autoplay='' loop='' muted='' playsinline/>")
  ](else:)[(display:_around)]
}

:: sex oral [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (set:$sex_loop to "licking loop " + $character's "id" + " ")
    (display:"sex oral " + $character's "id")
  ](else:)(display:_around)
}

:: sex pull out [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (set:$pullout_variant to (twist:1,4))
    (display:"sex pull out " + $character's "id")

    (if:$pullout_variant is 1)[
      (if:$his_choice is "tits")[
        (set:$your_choice to "tits")
        (if:$character's "race" is "black")[
          (set:$img to "/generic/sex/cum/tits/bbc/black " + (cond:
          (a:"A","B") contains ($character's breasts), "1",
          $character's "breasts" is "C", (text:(twirl:1,3)),
          (a:"D","E","F","G") contains ($character's breasts), "2",
          (text:(twist:1,3))))
        ] (else:)[
          (set:$img to "/generic/sex/cum/tits/bbc/white " + (cond:
          (a:"A","B") contains ($character's breasts), (text:(twirl:4,5)),
          $character's "breasts" is "C" and $character's "hair" is "blonde", "3",
          $character's "breasts" is "C", (text:(twirl:1,8)),
          (a:"D","E","F","G") contains ($character's breasts), (text:(twirl:2,6,7)),
          (text:(twist:1,8))))
        ]
      ] (else:)[
        (set:$his_choice to "pull out")
        (set:$your_choice to "pull out")
        (if:$position is "missionary")[
          (set:$img to "/generic/sex/cum/pull out/bbc/" + (cond:
          $character's "race" is "black" and (a:"D","E","F","G") contains ($character's breasts), "c2",
          $character's "race" is "black" and $character's "body type" is "slim", "c3",
          $character's "race" is "black", "c1",
          (a:"A","B") contains ($character's breasts), (text:(twirl:1,2,8)),
          $character's "breasts" is "C", (text:(twirl:3,4)),
          (a:"D","E","F","G") contains ($character's breasts), "6",
          (text:(twist:1,8))
          ))
        ]
        (else-if:$position is "riding")[
          (set:$img to "/generic/sex/cum/pull out/bbc/" + (cond:
          $character's "race" is "black", (twirl:"c1","c2","c3"),
          (text:(twirl:5,7))
          ))]
        (else-if:$character's "masculinity" < 80 and $orgasms > 0)[
          (set:$img to "/generic/sex/cum/pull out/bbc/wiggle/" + (cond:
          $character's "race" is "black" and $character's "body type" is "slim", (twirl:"c1","c3"),
          $character's "race" is "black", "c3",
          $character's "body type" is "slim", "2",
          "1"))
        ] (else:)[
          (set:$img to "/generic/sex/cum/pull out/bbc/no wiggle/" + (cond:
          $character's "race" is "black" and $character's "body type" is "voluptuous", "c3",
          $character's "race" is "black", (twirl:"c1","c2","c3"),
          $character's "body type" is "voluptuous", "1",
          (text:(twirl:2,3,4))
          ))
      ]

      (set:$text to $img of (dm:	
        "/generic/sex/cum/tits/bbc/black 1",(a:"tits","kneeling"),
        "/generic/sex/cum/tits/bbc/black 2",(a:"tits","lying"),
        "/generic/sex/cum/tits/bbc/black 3",(a:"tits","lying"),
        "/generic/sex/cum/tits/bbc/white 1",(a:"tits","lying",),
        "/generic/sex/cum/tits/bbc/white 2",(a:"tits","kneeling"),
        "/generic/sex/cum/tits/bbc/white 3",(a:"tits","couch"),
        "/generic/sex/cum/tits/bbc/white 4",(a:"tits","lying"),
        "/generic/sex/cum/tits/bbc/white 5",(a:"tits","lying"),
        "/generic/sex/cum/tits/bbc/white 6",(a:"tits","kneeling"),
        "/generic/sex/cum/tits/bbc/white 7",(a:"tits","lying"),
        "/generic/sex/cum/tits/bbc/white 8",(a:"tits","kneeling"),
        "/generic/sex/cum/pull out/bbc/1",(a:"body","couch"),
        "/generic/sex/cum/pull out/bbc/2",(a:"body","bed"),
        "/generic/sex/cum/pull out/bbc/3",(a:"body","couch"),
        "/generic/sex/cum/pull out/bbc/4",(a:"body","couch"),
        "/generic/sex/cum/pull out/bbc/5",(a:"body","couch"),
        "/generic/sex/cum/pull out/bbc/6",(a:"body","couch"),
        "/generic/sex/cum/pull out/bbc/7",(a:"body","bed"),
        "/generic/sex/cum/pull out/bbc/c1",(a:"body","couch"),
        "/generic/sex/cum/pull out/bbc/c2",(a:"body","couch"),
        "/generic/sex/cum/pull out/bbc/c3",(a:"body","couch"),
        "/generic/sex/cum/pull out/bbc/wiggle/1",(a:"butt","couch"),
        "/generic/sex/cum/pull out/bbc/wiggle/2",(a:"butt","couch"),
        "/generic/sex/cum/pull out/bbc/wiggle/c1",(a:"butt","couch"),
        "/generic/sex/cum/pull out/bbc/wiggle/c2",(a:"butt","couch"),
        "/generic/sex/cum/pull out/bbc/wiggle/c3",(a:"butt","bed"),
        "/generic/sex/cum/pull out/bbc/no wiggle/1",(a:"butt","bed"),
        "/generic/sex/cum/pull out/bbc/no wiggle/2",(a:"butt","floor"),
        "/generic/sex/cum/pull out/bbc/no wiggle/3",(a:"butt","bed"),
        "/generic/sex/cum/pull out/bbc/no wiggle/4",(a:"butt","bed"),
        "/generic/sex/cum/pull out/bbc/no wiggle/c1",(a:"butt","bed"),
        "/generic/sex/cum/pull out/bbc/no wiggle/c2",(a:"butt","couch"),
        "/generic/sex/cum/pull out/bbc/no wiggle/c3",(a:"butt","couch"),
      ))]]
    
    (set:$img to "<video src='img/scenes" + $img + ".mp4' autoplay='' loop='' muted='' playsinline/>")(set:$cum_text to $text)
  ](else:)[(display:_around)]
}

:: quicktime right image [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (if:$type is "transactional sex")[
    <!--(replace:?right_options)[(print: "<img class='greyborder' src='img/characters/sex/doggy/bbc/" +  $character's "id" + ".jpg' width='100%' height=auto>")]-->
    (replace:?right_options)[($pic:"characters/sex/doggy/bbc/" +  $character's "id" + ".jpg")]
    ](else:)[
    (replace:?right_options)[]
    ]
  ](else:)[(display:_around)]
}

:: masculinity initialize [around]
{
  (if:$minigame's "cock type" is "bbc")[
    (display:"masculinity test only bbc")
  ](else:)[(display:_around)]
}

:: masculinity test only bbc
{(set:$correct to 0)(set:$se to 0)
(set:$type to "normal")
(set:$exclude_cocks to (a:))

(set:$minigame's "cock type" to "bbc")
(set:_cocks to (range:1,32) + (range:970,999))
(set:_cockabilities to (twisted:..._cocks)) 
(set:$cock_array to (subarray:_cockabilities,1,$minigame's "difficulty"))

(set:$minigame's "babe type" to (cond:(is_bim:),"ahegao",(get_intellect:) < 3,"ahegao",(twirl:"ahegao","nsfw","clothed")))
(set:_possibilities to (twisted:...(range:1,309)))
(set:$babe_array to (subarray:_possibilities,1,$minigame's "difficulty"))

(set:"tries" of $minigame to 1)
(display:"masculinity calculate penalty")
(set:$index to 1)
}
(if:$babecock is "Masculinity Minigame: Disabled")[
  <div class='options'>(css:"font-size:4vmin")[**Masculinity Minigame Disabled**]
  You lose (print:"masculinity penalty" of $minigame) masculinity points and (print:(ceil:("masculinity penalty" of $minigame)/2)) identity. (if:$difference < 0)[
  ((print:-1 * $difference) less masculinity lost due to your reluctance of (print:$character's "reluctance"))](nl:2)(twirl:$minigame's "reason 1",$minigame's "reason 2",$minigame's "reason 3")(set:$character's "identity" to $character's "identity" - (ceil:("masculinity penalty" of $minigame)/2))(set:$character's "masculinity" to $character's "masculinity" - $minigame's "masculinity penalty")(display:"refresh stats")
  (link:"Next")[(set:$next to $minigame's "afterwards")(display:"change screen")]</div>]
(else:)[
  <div class='options'>(css:"font-size:4vmin")[**Black Cock Memory Test**]
  You're going to see (text:$minigame's "difficulty") pairs of images. Try to remember which girl goes with which BBC.
  (link:"BEGIN LEARNING PHASE")[(set:$next to "masculinity learning")(display:"next")]
  (link:"SKIP (Maximum Identity Loss)")[
    (set:$character's "identity" to $character's "identity" - $minigame's "identity penalty")
    (set:$character's "masculinity" to $character's "masculinity" - $minigame's "masculinity penalty")
    (display:"refresh stats")(set:$next to $minigame's "afterwards")(display:"change screen")
  ]
]

:: invite guy sex room [around]
{
  (display:_around)
  (if:(checkdm:$npc, "race", "is", "black"))[
    (set:$minigame's "cock type" to "bbc")
  ]
}

:: sex transactional end [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (if:$scene's "events" contains "oral")[
      (set:$blacked_stats's "cunnilingus received" to it + 1)
      (set:$blacked_daily_stats's "cunnilingus received" to it + 1)
    ]
  ]
  (display:_around)
}

:: bar dance start [around]
{
  (display:_around)
  (set:$minigame's "cock type" to "bbc")
}
:: bar dance end [around]
{
  (set:$minigame's "cock type" to "bbc")
  (display:_around)
  (display:"blacked sex tally")
}

:: bar dance start blowjob [around]
{
  (display:_around)
  (set:$blacked_stats's "blowjobs given" to it + 1)
  (set:$blacked_daily_stats's "blowjobs given" to it + 1)
}

:: bar dance start sex [around]
{
  (display:_around)
  (set:$blacked_stats's "sex as girl" to it + 3)
  (set:$blacked_daily_stats's "sex as girl" to it + 3)
}

:: dredd job sex they orgasm 4 [around]
{
  (display:_around)
  (set:$minigame's "cock type" to "bbc")
  (set:$blacked_stats's "blowjobs given" to it + 1)
  (set:$blacked_daily_stats's "blowjobs given" to it + 1)
  (set:$blacked_stats's "sex as girl" to it + 1)
  (set:$blacked_daily_stats's "sex as girl" to it + 1)
  (display:"blacked sex tally")
}

:: story the fisherman sex 15 pose options [around]
{ <!-- This specifically applies to Quoqac -->
  (display:_around)
  (set:$minigame's "cock type" to "bbc")
}

:: story the fisherman sex 17 [around]
{
  (display:_around)
  (set:$blacked_stats's "blowjobs given" to it + 1)
  (set:$blacked_daily_stats's "blowjobs given" to it + 1)
}

:: fisherman sex end [around]
{
  (display:_around)
  (display:"blacked bbc sex checks")
}

:: sales demo sex begin [around]
{
  <!-- demo names:
  goodgirl basic
  goodgirl max
  goodgirl petite
  dumb bitch
  insta strip
  hot and ready
  secretary
  ready maid
  dairy queen
  -->
  (display:_around)
  (if:$product's "id" is "goodgirl basic")[(set:$minigame's "cock type" to "bbc")]
  (display:"blacked bbc sex checks")
}

:: sales demo strip [around]
{
  (display:_around)
  (if:$product's "id" is "goodgirl basic")[(set:$minigame's "cock type" to "bbc")]
}

:: sales demo bj [around]
{
  (display:_around)
  (if:$product's "id" is "goodgirl basic")[(set:$minigame's "cock type" to "bbc")]
  (set:$blacked_stats's "blowjobs given" to it + 1)
  (set:$blacked_daily_stats's "blowjobs given" to it + 1)
}

:: girl rough dirty talk [around]
{ 
  <!-- For Male MC talking to Female NPC -->
  (if:(checkdm:$character, "race", "is", "black"))[
    (nl:2)
    [
      "(twirl:"Fuck yes","Yesss","Mmmm","Oh fuck yes","Oh god, yes","Oh yeah, fuck","Yeah")
      (twirl:"...","!")
      (if:$position is "bj")[
        (twirl:"That's a good little slut","Good bitch","You're such a well-trained little whore","You're good at this, slut","You're obviously an experienced little whore","Just like that, slut")
      ](else-if:$position is "riding")[
        (twirl:"Just like that","Ride me just like that","Keep going, just like that","Your pussy is so tight","Your pussy feels so good","Your pussy feels so fucking tight","Ride me, yeah, keep going","Keep going","Just like that","That feels amazing")
        , (twirl:"bitch","you slut","slut","whore")
      ](else:)[(if:(twist:1,2) is 1)[
        (twirl:"Take this big black cock","Take my black dick","This feels amazing","Your pussy is so tight","You feel so good clenching daddy's black cock")
        , (twirl:"bitch","you slut","slut","whore")
      ](else-if:$npc's "race" is "white")[
        (twirl:"You're such a good little snowbunny","You're daddy's personal white slut now","You're such a pretty white trash princess","You're just another Phat Ass White Girl to me, slut")
      ](else:)[
        (twirl:"You're such a good little fuck-slut","You're daddy's little black cock whore now","You're addicted to BBC","You're just a set of holes to me, slut")
        ]
      ]
        (twirl:"...",",")" you say.
        (unless:$npc's "traits" contains "religious")[(set:$her_arousal to $her_arousal + 2)(display:"npc screen update sex girl")]]
  ](else:)[(display:_around)]
}

:: girl introduce yourself [around]
{
  (unless:(is_fem:))[
    (display:"blacked compatibility check")
    (if:$blacked_compatible is 1)[
      (display:"load relationship")
      (if:$npc's "traits" contains "only bbc")[
        (if:$character's "race" is "black")[
          (set:$relationship's "attraction" to 10)
          (twirl:"Why hello handsome... I'm","Mmm, dark chocolate...yummy. Hi there, name's","My, what a nice chocolatey surprise. I'm") (print:$npc's "name").
          (print:$character's "male name")(twirl:", care to make my night less boring?", ", I got a bed at my place with your name on it.", ". Hmm, I'll have to remember that. In case I need to scream it later.")
          ]
        (else:)[
          (set:$relationship's "attraction" to (cond:
          $blackfreq is "Black Encounters: Normal", (twist:-16,-12),
          $blackfreq is "Black Encounters: Less", (twist:-12,-8),
          $blackfreq is "Black Encounters: More", (twist:-20,-16),
          $blackfreq is "Black Encounters: Always", -25,
          ,0
          ))
          "(twirl:
              "Sorry, I'm flattered and all that, but",
              "Sorry, but",
              "I'm gonna stop you there."
          )
          (cond:
          $blackfreq is "Black Encounters: Normal", (twirl:"I like my men the same way I like my coffee. Black and full of cream.","I only date black guys. They're just so strong...","I'm only looking to date black guys."),
          $blackfreq is "Black Encounters: Less", (twirl:"I really only date black guys.","I'm really only into black men.","I'm only dating black now."),
          $blackfreq is "Black Encounters: More", (twirl:"I only date black men. Can you blame me?","Black men are the only ones that can truly satisfy my needs...","I exclusively fuck black men. It's true what they say... Once you go black, you never go back."),
          $blackfreq is "Black Encounters: Always", (twirl:"I'm black-only, honey. A true Queen of Spades.","I only data black alpha studs... not inferior beta cucks like you.","I only fuck big black cocks... they're the only thing that can satisfy a white girl like me."),
          ,""
          )"

          (nl:1)
          (cond:
          $blackfreq is "Black Encounters: Normal", (twirl:"Maybe you still can win her over, if you play your cards right...","Well that went well. Should you give up?"),
          $blackfreq is "Black Encounters: Less", (twirl:"She's probably all talk. Go ahead, shoot your shot.","Maybe she just hasn't met the right guy... Go on, talk to her."),
          $blackfreq is "Black Encounters: More", (twirl:"She seemed pretty serious... and kinda bitchy. But maybe you could still try?","She seemed sure of herself... should you respect her wishes?"),
          $blackfreq is "Black Encounters: Always", (twirl:"Wow. She's serious, isn't she? That's some racist ass shit...","Wow...she blew you off just like that. For not being black."),
          ,""
          )

          (set:$bar_spike_chance to it + (cond:
          $blackfreq is "Black Encounters: Normal", 2,
          $blackfreq is "Black Encounters: Less", 1,
          $blackfreq is "Black Encounters: More", 3,
          $blackfreq is "Black Encounters: Always", 5,
          ,0
          ))
          (if:$blackfreq is "Black Encounters: Always")[(set:$uninterested to "true")]
          ]
        (set:$events to $events + (a:"introduce"))
        (set:$npc's "events" to $npc's "events" + (a:"introduce"))
        (set:$npc's "familiarity male" to 1)
        (display:"update relationship name girl")
        (set:$npc_select of $relationships to $relationship)
        <div class='options'><mark>First impression:</mark></div>(set:$boredom to $boredom - $relationship's "attraction")
        (display:"display relationship status")
        (display:"bar chat girl options")
        ](else:)[(display:_around)]
    ](else:)[(display:_around)]
  ](else:)[(display:_around)]
}

:: bar chat girl greeting [around]
{
  (if:(is_fem:))[
        (display:"bar chat girl options female")
    ](else:)[
    (if:$npc's "traits" contains "only bbc" and $character's "race" is not "black" and $npc's "events" contains "introduce" and $uninterested is "true")[
      (text:"She isn't into " + ($character's "race") + " " + (twirl:"guys","boys") +".")
      (nl:2)
      (if:$npcs_present contains "dredd")[
        (twirl:
              "She's not even acknowleding you. She can't stop staring at Dredd.",
              "Her eyes are on dark chocolate tonight.",
              "Why would she talk to you, when Dredd is right over there.",
              "She flips you off, then walks over and sits on Dredd's lap.",
              "She's too busy eye-fuckin Dredd to notice you.",
              "She dismisses you, her eyes are glued on Dredd...well his pants."
          )
      ](else:)[
          (twirl:
              "She already told you no. You're the wrong race for her.",
              "She just laughs at you.",
              "You're wasting your time, she doesn't want to talk to you.",
              "She rolls her eyes at you.",
              "Unless there's a pill that can turn you into a Black stud, she isn't going to talk to you."
          )
      ]]
    (else-if:$npc's "traits" contains "only bbc" and $character's "race" is not "black" and $npc's "events" does not contain "introduce")[
      (twirl:
              "She catches you staring at her...",
              "Why are the hot ones always so intimidating.",
              "There's an awkward silence..."
      )
    ]
    (else:)[(display:_around)]
    ]
}

:: bar chat girl options [around]
{
  <div class="options">
  (if:(is_fem:))[
        (nl:1)
        (display:"bar chat girl options female")
    ](else:)[
    (if:$npc's "traits" contains "only bbc" and $character's "race" is not "black" and $npc's "events" contains "introduce" and $uninterested is "true")[
      (nl:1)
      (link:"Leave her alone")[
        (display:"save npc")
        (set:$next to "bar chat patrons")
        (display:"change screen")]
      ]
    (else-if:$npc's "traits" contains "only bbc" and $npc's "events" does not contain "introduce")[
      (nl:1)
      (link:"Introduce yourself")[
        (set:$next to "girl introduce yourself")
        (display:"change screen")
        (set:$line to $npc's "name")
        (display:"bar npc voice line")
        ]
    ]
    (else:)[(display:_around)]
    ]</div>
}

:: invite guy load [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (if:($blacked_compatible is 0))[
      (set:$se to "phone call")(display:"play sound")
      (set:$ambience to "bedroom")
      (display:"play ambience")

      (unless:(datanames:$npc) contains "known mc ids")[
        (set:$npc's "known mc ids" to (a:$character's "real id"))
      ]
      (unless:$npc's "known mc ids" contains $character's "id")[
        (set:$result to "fail")
        (if:$option is "he called you")[
          You say sure, but let him know]    
        (if:$option is "you called him")[
          You call up (print:$npc's name) and explain] 
          that you've changed bodies since the last time you saw him. (twirl:"Now, instead of ","Now, in place of ")
          {(display:"invite guy load old " + last of ($npc's "known mc ids"))}
          (print:" you have transformed into a ")
          {(display:"invite guy load new " + $character's id)}.
        (nl:2)
          "(twirl:"Bitch, you crazy.","Aw hell naw, you sound just like my ex. You got me all fucked up.","Yeah... maybe some other time...")" he says, and hangs up.
          <div class='options'>(link:"Next")[(display:"advance time")]</div>
      ]
    ](else:)[(display:_around)]
  ](else:)[(display:_around)]
}

:: breedify npc [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (set:$npc's tags to it - (a:"gentleman"))
    (set:$npc's tags to it + (a:"breeder"))
    (set:$npc's personality to (min:it,5))
    ($use_global: "$black_cock_database", "window.GE.black_cock_database", [(set:$npc to it + (twirl:...(find:_cock where _cock's ballsize is 10, ...$black_cock_database)))])
](else:)[(display:_around)]
}

:: bigcockify npc [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    ($use_global: "$black_cock_database", "window.GE.black_cock_database", [(set:$npc to it + (twirl:...(find:_cock where _cock's ballsize is 10 and cockrating is 10 and cocklength is 10 and cockfatness is 10, ...$black_cock_database)))])
  ](else:)[(display:_around)]
}

:: npc fill in details [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (unless:(datanames:$npc) contains "last name")[(display:"random guy last name")]
    (unless:(datanames:$npc) contains "sex name")[(set:$npc's "sex name" to $npc's "name")]
    (unless:(datanames:$npc) contains "events")[(set:$npc's "events" to (a:"name"))]
    (unless:(datanames:$npc) contains "fitness")[(set:$npc's "fitness" to (twist:4,6))]

    (unless:(datanames:$npc) contains "cocklength")[
    ($use_global: "$black_cock_database", "window.GE.black_cock_database", [{
        (set:$npc to it + (twirl: ...$black_cock_database))
      }])]
  ](else:)[(display:_around)]
}

:: proposition pet name [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (unless:$npc contains "petname")[
      (set:$petname to "none")
      (if:$pickup is "racial")[
        (if:$character's race is "white")[
          (if:$npc's tags contains "bully")[
            (set:$petname to (twirl:"my spoiled little snowbunny", "my pale princess", "my uptight snow white angel", "my snow white brat", "my ivory tease", "my little porcelain prize", "prissy white girl", "my fair-skinned bitch"))
          ]
          (else-if:$npc's tags contains "nerd")[
            (set:$petname to (twirl:"my anime waifu", "my player two", "my little level-up queen", "my cosplay princess", "my comic con cutie", "my magic card goddess", "my white mage", "my fantasy elf", "my sci-fi siren", "my tabletop temptress"))
          ]
          (else-if:$npc's tags contains "nice")[
            (set:$petname to (twirl:"my lovely snow angel", "my stunning vanilla beauty", "my gentle ivory rose", "my fair queen", "my elegant fair-skinned goddess", "my soft-spoken angel", "my delicate dream", "my ivory enchantress", "my sweet darling"))
          ]
          (else:) [
            (set:$petname to (twirl:"my snowbunny", "my vanilla queen", "my ivory goddess", "my fair-skinned stunner", "my white-hot babe", "my sweet milkshake", "my creamy dream", "my snow angel", "my soft-skinned treat"))
          ]
        ]

        (else-if:$character's race is "asian")[
          (if:$npc's tags contains "bully")[
            (set:$petname to (twirl:"my little China doll", "my delicate plaything", "my uptight lotus", "my quiet little tease", "my soft-spoken doll", "my demure annoyance", "my porcelain pest", "my stubborn cherry blossom", "my silk-skinned troublemaker", "my ivory irritation"))
          ]
          (else-if:$npc's tags contains "nerd")[
            (set:$petname to (twirl:"my otaku dream", "my waifu IRL", "my little cosplayer", "my manga queen", "my kawaii goddess", "my video game rival", "my senpai", "my little anime babe", "my pocket healer", "my RPG rogue"))
          ]
          (else-if:$npc's tags contains "nice")[
            (set:$petname to (twirl:"my lovely cherry blossom", "my graceful lotus", "my gentle jade beauty", "my delicate angel", "my soft-spoken queen", "my sweet muse", "my beautiful pearl", "my tender silk doll", "my charming goddess", "my little joy"))
          ]
          (else:) [
            (set:$petname to (twirl:"my exotic cutie", "my little cherry blossom", "my Asian goddess", "my lithe dream", "my petite powerhouse", "my fierce tigress", "my feisty firecracker", "my silk-skinned queen", "my breathtaking lotus", "my bold jade beauty"))
          ]
        ]

        (else-if:$character's race is "latin")[
          (if:$npc's tags contains "bully")[
            (set:$petname to (twirl:"my spicy pest", "my little firecracker", "my stubborn Latina", "my bossy se√±orita", "my fiery troublemaker", "my sassy Latina doll", "my feisty annoyance", "my spicy handful", "my hot-headed princess", "my wild brat"))
          ]
          (else-if:$npc's tags contains "nerd")[
            (set:$petname to (twirl:"my RPG rogue", "my anime senorita", "my little tabletop queen", "my game-night goddess", "my pop-culture babe", "my little comic-con cutie", "my senpai", "my cosplaying queen", "my nerdy Latin doll", "my kawaii Latina"))
          ]
          (else-if:$npc's tags contains "nice")[
            (set:$petname to (twirl:"my beautiful se√±orita", "my Latin rose", "my graceful muse", "my sweet salsa queen", "my warm-hearted angel", "my loving little rose", "my charming goddess", "my tender Latina beauty", "my elegant se√±orita", "my darling treasure"))
          ]
          (else:) [
            (set:$petname to (twirl:"my spicy se√±orita", "my salsa queen", "my hot tamale", "my fiery Latina bombshell", "my luscious Latina", "my curvy firecracker", "my sultry salsa goddess", "my bold Latina princess", "my caliente muse", "my Latin flame"))
          ]
        ]
      ]

      (else-if:$pickup is "body")[
        (if:$trigger is "breasts")[
          (set:$petname to (twirl:"my big-titted beauty", "my big-breasted beauty", "my big-breasted bombshell", "my cute lil' milk truck", "my busty babe", "my top-heavy temptress", "my voluptuous vixen", "my curvaceous cutie", "my stacked sweetheart", "my full-figured fox"))]
          (else-if:$trigger is "butt")[(set:$petname to (twirl:"little miss fat-ass", "my big-assed cutie", "my big-assed bombshell", "my little dumptruck", "my bootylicious babe", "badonkadonky kong","my peachy princess","princess peachy"))
        ]
      ]
    
      (if:$petname is "none")[
        (if:$npc's "tags" contains "coworker")[
          (set:$petname to (twirl:"sweet thing","sugar lips","pretty lady","lil‚Äô heartbreaker","hot stuff","beautiful","gorgeous","miss thang","lil‚Äô temptress","mami","suga‚Äô"))
        ](else-if:$npc's tags contains "nerd")[
          (set:$petname to (twirl:"goddess", "cutie", "my queen"))
        ](else:)[
          (set:$petname to (twirl:"cutie", "baby", "doll", "sweetie", "hun", "babe", "my lovely"))
        ]
      ]

      (if:$npc's "age" < 23 and (twist:1,3) is 1)[
        (set:$petname to (twirl:"bae", "my lil' snacc", "shawty", "lil' mama", "bad biddie", "fire emoji","dime piece"))
      ]
      
      (set:$npc's "petname" to $petname)
    ] 
    (if:$npc's "dominance" > 6 and $npc's "personality" < 5)[(display:"asshole gives you a petname")]
  ]
  (else:)[(display:_around)]
}

:: asshole gives you a petname [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (if:$character's race is "white")[
      (set:$petname to (twirl:"my filthy little snowbunny", "my slutty black cock whore", "my dirty milkmaid whore", "my pale-skinned cum dump", "my white trash slut", "trailer park queen", "my little white-bred cock holster", "my BBC fucktoy", "my submissive cream slut"))
    ]
    (else-if:$character's race is "asian")[
      (set:$petname to (twirl:"my tight little geisha slut", "my exotic cum rag", "my submissive ricebunny", "my obedient rice slut", "my little geisha whore", "my Asian cock sleeve", "my silk-skinned cum bucket", "my dirty oriental fucktoy"))
    ]
    (else-if:$character's race is "latin")[
      (set:$petname to (twirl:"my little spicybunny", "my Latina cum dumpster", "my slutty brown plaything", "my filthy tamale slut", "my little salsa cock puppet", "my taco temptress", "my spicy cock slut", "my dirty chica whore"))
    ]
    (else-if:$character's race is "black")[
      (set:$petname to (twirl:"my little brownbunny", "my dirty hoodrat bitch", "my filthy black slut", "my little black cock puppet", "my chocolate whore", "my BBC slut", "my black cum guzzler"))
    ]
    (else:)[
      (set:$petname to (twirl:"my nasty little fucktoy", "my filthy cum rag", "jungle fever junkie", "my black cock whore", "my BBC slut", "my stupid little cumdump", "my obedient cockholster", "my horny little meat puppet", "my slutty little sidepiece", "my trashy fuckdoll"))
    ]
    (set:$npc's "petname" to $petname)
  ]
  (else:)[(display:_around)]
}

:: sex transactional butt comment [around]
{ <!-- This is here because the original has a reference for scarlit about black girls, which a black man wouldn't make. Rest of the passage was fine as-is -->
  (if:(checkdm:$npc, "race", "is", "black"))[
    (if:$character's "id" is "scarlit")[
      (set:$phat to (twirl:"phat","round","peachy","premi-*yum*","fantASStic","thick","fat","fat","nice, round","humongous","juicy","beautiful"))
      (set:$butt to (twirl:"ass","butt","rear","ass","trunk","ass","ass","butt","badonkadonk"))
      "(twirl:"Your ass is literally built for grabbing.","That $butt has a NICE jiggle to it.","That $butt is nice and FAT!","That $butt is nice and PHAT.","Nice $butt. You could bounce quarters off that thing,")"
      (if:$outfit's "tags" contains "nude")[
        ($pic:"characters/nude/butt/" + $character's "id" + ".jpg")]
      (unless:(datanames:$npc) contains "petname")[
        (set:$npc's petname to (twirl:"little miss fat-ass","my big-assed cutie","my big-assed bombshell","my little dumptruck","my nice slice of cake"))
        "(twirl:"I'm gonna call you","Think I'm gonna call you","Gonna call you") (print:$npc's petname)(twirl:" from now on.",".")"(set:$petname to $npc's petname)]
    ]
  ](else:)[(display:_around)]
}

:: transactional sex describe he talks [around]
{
  (if:(checkdm:$npc, "race", "is", "black"))[
    (set:_race to $character's "race")
    (set:_cock to (cock:"rating","npc"))
    (set:_tags to $npc's "tags")
    (set:_personality to $npc's "personality")
    (set:_age to $npc's "age")

    (set:_phat to (cond:
      $character's "butt" is "slim", (twirl:"peachy", "slender", "cute lil'", "juicy", "cute", "tight", "perky", "premi-*yum*", "fantASStic", "nice", "beautiful", "delicate", "petite", "sleek", "smooth", "lean", "compact", "grabbable", "toned", "trim", "firm", "dainty"),
      $character's "butt" is "bubble", (twirl:"round", "peachy", "fat", "heart-shaped", "dump-truck", "juicy", "bimbo-sized", "cute", "tight", "perky", "premi-*yum*", "fantASStic", "nice", "beautiful", "plump", "squeezable", "bouncy", "curvy", "shapely", "alluring", "cushiony", "voluptuous", "mouthwatering"),
      $character's "butt" is "big", (twirl:"big", "round", "peachy", "thick", "fat", "jiggling", "juicy", "bimbo-sized", "mega-size", "premi-*yum*", "fantASStic", "nice", "humongous", "beautiful", "massive", "lush", "hefty", "overflowing", "gigantic", "sumptuous", "immense", "heaving", "plush", "cushion-like"),
      (twirl:"phat","round","peachy","premi-*yum*","fantASStic")
    ))

    (set:$tits to (cond:
      $character's "breasts" is "A" or $character's "breasts" is "B",(twirl:"tits","boobs","tits","boobs","bee stings","itty-bitties","little cherries"),
      $character's "breasts" is "C" or $character's "breasts" is "D",(twirl:"milkers","tits","udders","boobs","tits","boobs"),
      (twirl:"massive milkers","udders","bazongas","tits","milkers","udders","cow-tits","boobs","big, floppy tits")
    ))

    (set:_girl to (cond:
      _age > 39 and (twist:1,2) is 1 and _race is "black", (twirl:"lady","woman","doll","cutie","girl","sweetie","babe"),
      _age > 39 and (twist:1,2) is 1, (twirl:"lady","woman","doll","cutie","_race girl","sweetie","_race babe","girl","babe"),
      _age < 20 and (twist:1,2) is 1 and _race is "black", (twirl:"shawty","bae","baddie","cutie","girlie","chick","shorty","sweetie","girl"),
      _age < 20 and (twist:1,2) is 1, (twirl:"shawty","bae","_race baddie","cutie","girlie","_race chick","shorty","sweetie","_race girl","girl","baddie","chick"),
      _race is "black" and (_tags contains "fuckboy" or _tags contains "jock" or _tags contains "bully" or _tags contains "chad"), (twirl:"slut","chick","thot","baddie","hottie","tease","piece","snack"),
      _tags contains "fuckboy" or _tags contains "jock" or _tags contains "bully" or _tags contains "chad", (twirl:"_race slut","chick","_race thot","baddie","_race hottie","tease","piece","_race snack","thot","slut","hottie","snack"),
      _race is "black" and (_tags contains "gentleman" or _tags contains "nice" or _tags contains "nerd"), (twirl:"lady","sweetheart","cutie","angel","beauty","darling","queen"),
      _tags contains "gentleman" or _tags contains "nice" or _tags contains "nerd", (twirl:"lady","sweetheart","_race cutie","_race angel","_race beauty","darling","_race queen","queen","cutie","beauty","angel"),
      (twirl:"girl","lady","beauty","babe","woman","girl","girl","lady")
    ))

    (set:_cum to (cond:
    _race is "black", (twirl:"cum","cum","cum","load","seed","jizz"),
    (twirl:"black cum","black cum","cum", "cum","load","black seed","jizz")
    ))

    (set:$your_sex_name to (twirl:"bitch","slut","whore",$your_name,$your_name,"bitch","slut"))
    (if:_tags contains "gentleman")[(set:$your_sex_name to (twirl:$your_name,$your_name,"baby","babygirl",$petname,$petname))]
    (if:_tags contains "fuckboy")[(set:$your_sex_name to (twirl:"bitch","slut","whore","cunt",$your_name,$your_name,"bitch","slut","babygirl","babygirl"))]
    (if:_tags contains "chad")[(set:$your_sex_name to (twirl:"bitch","slut","whore",$your_name,$your_name,"bitch",$your_name,$your_name,"slut","fucktoy"))]
    (if:_tags contains "creepy")[(set:$your_sex_name to (twirl:"bitch","slut","whore",$your_name,$your_name,"bitch",$your_name,$your_name,"slut","cunt","cunt","fucktoy",$petname,$petname,"you little slut"))]
    (if:_tags contains "jock")[(set:$your_sex_name to (twirl:"bitch","slut",$your_name,$your_name,"bitch",$your_name,$your_name,"slut","fucktoy"))]

    (set:$dick to (twirl:"cock","dick","cock","cock"))
    (if:_cock > 7 and (twist:1,2) is 1)[(set:$cock to (twirl:"big $dick","big, fat $dick","big fucking $dick","fucking cock","big ol' schlong"))](else:)[(set:$cock to $dick)]

    (set:$pussy to (twirl:"tight little pussy","pussy","wet little pussy","pussy","wet little cunt","pussy","pussy"))
    (if:$npc's "age" > 39)[(set:$pussy to (twirl:"tight young pussy","pussy","wet little pussy","pussy","wet little cunt","pussy","pussy"))]

    (set:$face to (twirl:"pretty little face","pretty face","cute little face","pretty face","beautiful face","face","face","face"))
    (if:$npc's "personality" < 4)[(set:$face to (twirl:"stupid little face","pretty face","whorish little face","slutty face","beautiful face","face","stupid face","face","dumb little face"))]

    (if:_race is "black")[
      (if:_cock > 7 and _tags contains "chad")[(set:$cock to (twirl:"bitch-wrecker","big, fuck-stick","big fat cock","slut-wrecker","slut-stick","slut-maker","big fuckpole","bitch-breaker"))]
      (if:_cock > 7)[(set:$cock to (twirl:"big $dick","big, thick $dick","big $dick"))]
      (if:_personality < 6)[(set:$pussy to (twirl:"tight little pussy","pussy","cunt","tight little pussy","wet little pussy","pussy","wet little cunt","pussy","cunt"))]
    ] (else:)[
      (if:_cock > 7 and _tags contains "chad")[(set:$cock to (twirl:"bitch-wrecker","big, black fuck-stick","big fat black $dick","slut-wrecker","slut-stick","slut-maker","big black fuckpole","bitch-breaker"))]
      (if:_cock > 7)[(set:$cock to (twirl:"big black $dick","big, black $dick"))]
      (else:)[(set:$cock to (twirl:"black $dick","$dick"))]
      (if:_personality < 6)[(set:$pussy to (twirl:"tight little _race pussy","_race pussy","_race cunt","tight little pussy","wet little _race pussy","pussy","wet little _race cunt","_race pussy","pussy"))]
    ]

    (set:$descriptions to (twisted:"take my cock","own this pussy","feels good","cum choice","cant believe","you love it","cum soon","look back","grab boobs","grab butt","pull hair","tits clap","spank","push down"))
    (if:$npc's tags contains "breeder")[(set:$descriptions to (twisted:"cum choice","cum choice",...$descriptions))]
    (unless:$his_choice is "none")[(set:$descriptions to $descriptions - (a:"cum choice"))]
    (unless:($npc's "looks" < 5) or $npc's "tags" contains "nerd" or ($npc's "age" > 39) or ($npc's "age" < 20) or $npc's "tags" contains "chubby")[
    (set:$descriptions to $descriptions - (a:"cant believe"))
    ]
    (if:$npc's "tags" contains "chad" or $npc's "tags" contains "jock")[(set:$descriptions to $descriptions - (a:"cant believe"))]

    (unless:$his_pleasure_threshold - $his_pleasure < 4)[(set:$descriptions to $descriptions - (a:"cum soon"))]
    (unless:$doggy_text contains "look back")[(set:$descriptions to $descriptions - (a:"look back"))](unless:$doggy_text contains "grab boobs")[(set:$descriptions to $descriptions - (a:"grab boobs"))](unless:$doggy_text contains "grab butt")[(set:$descriptions to $descriptions - (a:"grab butt"))](unless:$doggy_text contains "pull hair")[(set:$descriptions to $descriptions - (a:"pull hair"))](unless:$doggy_text contains "tits clap")[(set:$descriptions to $descriptions - (a:"tits clap"))](unless:$doggy_text contains "spank" and $npc's "personality" < 5)[(set:$descriptions to $descriptions - (a:"spank"))](unless:$doggy_text contains "push down" and $npc's "personality" < 5)[(set:$descriptions to $descriptions - (a:"push down"))]
    (set:$description to 1st of $descriptions)

    (if:$description is "feels good")[(inc:'his_pleasure')(display:"update his pleasure")]
    (if:$description is "cum choice")[(set:$his_choice to (twirl:"creampie","pull out","face","mouth","creampie"))(if:_tags contains "breeder")[(set:$his_choice to "creampie")]]


    (set:$text to (cond:
    $description is "push down", (twirl:"face down, ass up - just like nature intended","get down","stay right there. I'm gonna fuck you hard until I nut","this is nature's perfect fucking position","stay down while I fuck you"),
    $description is "spank", (twirl:"you're a bad girl","I'm treating you like the BAD girl you are","you know who owns you now, huh? Yeah you do","take this! And this","who's a naughty little $girl, huh? You are"),
    $description is "tits clap", (twirl:"I love watching those $tits clap together","I'm making those $tits clap together","your $tits are giving each other a high five","I love makin' those titties clap"),
    $description is "pull hair", (twirl:"I love pulling your hair while I fuck you","I love pulling your hair","hair is a girl's natural handle"),
    $description is "grab butt", (twirl:"I love watching this _phat ass jiggle","I love watching your _phat ass bounce and jiggle on my $cock","I love making your _phat ass jiggle"),
    $description is "grab boobs", (twirl:"your $tits feel so good","love these $tits of yours","I love how your $tits swing","I love these $tits"),
    $description is "look back", (twirl:"look at me while I fuck you. Just like that","look back at me while I fuck you","you're going cross-eyed","I think you're going cross-eyed","your eyes are rolling back in your head - must mean you're enjoying this"),
    $description is "cum soon" and _tags contains "breeder", (twirl:"I'm fixin' to bust a nut in you","I feel it coming... I'm gonna breed that fucking $pussy now","Fuck yes, take it slut, you'll make a great single mother"),
    $description is "cum soon", (twirl:"I'm gonna cum soon","I think I'm gonna nut soon","you're gonna make me blow","you're gonna make me nut","you're gonna make me cum real soon"),
    $description is "you love it" and _tags contains "breeder" and _race is not "black", (twirl:"you WANT to make some mixed babies","you WANT to carry my baby in that _race womb","you WANT me to empty these black balls inside you, and make you fucking pregnant","you WANT me to fucking breed that $pussy of yours"),
    $description is "you love it" and _tags contains "breeder" and _race is "black", (twirl:"you WANT to have my baby","you WANT to carry my baby in your womb","you WANT me to empty these balls inside you, and make you fucking pregnant","you WANT me to fucking breed that $pussy of yours"),
    $description is "you love it" and _tags contains "nerd", (twirl:"you love this! You're making the ahegao face","your $face looks like one of those girls in hentai","you love this, don't you? You should see the look on your face","you fucking love my $cock","you love getting fucked like this","you love getting used by my $cock","you love getting fucked","you just LOVE getting pounded, don't you? Yeah you do","you should see the look of bliss on your $face"),
    $description is "you love it", (twirl:"that look on your $face - you love this","you should see yourself in the mirror, you love this $cock","you love this $cock, don't you? You should see the look on your face","you fucking love my BBC","you love getting fucked like this","you love getting used by my $cock","you love getting fucked","you just LOVE getting pounded a big strong man, don't you? Yeah you do","you should see the look of bliss on your $face"),
    $description is "cant believe" and $npc's "looks" < 5 and _tags contains "breeder" and _race is "black", (twirl:"I might be ugly, but our kids are gonna be good looking, like you","Summer City is great, even an ugly guy like me can breed a _girl like you"),
    $description is "cant believe" and $npc's "looks" < 5 and _tags contains "breeder", (twirl:"I might be ugly, but our mixed kids are gonna be good looking, like you","Summer City is great, even an ugly guy like me can breed a _girl like you"),
    $description is "cant believe" and $npc's "looks" < 5, (twirl:"I guess even ugly guys like me can get lucky. Can't believe I get to fuck a hot _girl like you","Summer City is great - even an ugly guy like me can fuck a _girl as hot as you","and my friends say I'm out of my league, hitting on a _girl like you","can't believe I get to fuck you","can't believe I really get to fuck $pussy tonight"),
    $description is "cant believe" and $npc's age < 21 and _tags contains "breeder", (twirl:"I can't believe I'm breeding a _girl in her 20s. Yeah! This is fucking lit","this is wack. Can't believe I'm gonna impregnate a _girl who looks like a fucking pornstar, when I'm only _age","I'm only _age and already making mixed babies","can't believe I'm only _age, and getting to breed a hot _girl like you"),
    $description is "cant believe" and $npc's age < 21 and _tags contains "nerd", (twirl:"I guess even nerds like me can get lucky. Can't believe I get to fuck you","Summer City is great - even a nerdy guy like me can fuck a hot _girl like you","and my friends say I'm out of my league, hitting on girls like you","can't believe I get to fuck you","can't believe I really get to fuck a hot _girl... I'm gonna tell all my friends","this is just like fucking anime chicks","this is even better than porn","this is so much better than watching porn","I guess my mom was right when she said to get outside and meet girls","can't believe a hot _girl like you would even talk to a nerd like me","can't believe I'm fucking a _girl like you","you're even hotter than my anime statues"),
    $description is "cant believe" and $npc's age > 39, (twirl:"I can't believe an old guy like me gets to fuck a $girl like you","I can't believe I'm fucking a hot _girl like you","can't believe I'm fucking a $girl like you","at my age, I didn't think I'd get to taste a sweet _girl like you again","your $pussy is like the fountain of youth for me"),
    $description is "cant believe", (twirl:"I can't believe I get to fuck a hot _girl like you","Can't believe I get to fuck a _girl as hot as you","can't believe I'm fucking you right now"),
    $description is "take my cock" and (_tags contains "chad" or _tags contains "jock"), (twirl:"that's right, take my $cock","feel my $cock inside your $pussy","take my $cock like a good little _girl","take it. Take my fucking cock","you love it. Yeah, you love my fucking cock","you'll be thinking about my $cock for weeks after this. Yeah, take it","take. My. Fucking. Cock. Yes! Take it"),
    $description is "take my cock" and _tags contains "fuckboy", (twirl:"this is what girls like you were made for. Taking my $cock","take it like a good little _girl. Yeah, just like that","take my $cock. Feel it inside you, slut. Yeah - FUCK"),
    $description is "take my cock" and (_tags contains "bully"  or $npc's personality < 3), (twirl:"this is what you're made for. Taking my $cock","take it like a good _girl. Yeah, just like that","I bet you'll dream about my $cock for weeks after this, ho. Yeah, take it","take this $cock. Feel it inside you, slut. Yeah - FUCK"),
    $description is "take my cock" and (_tags contains "gentleman" or $npc's personality > 7), (twirl:"I hope this feels as good for you as it does for me. Taking my $cock","enjoy yourself on my $cock","take my $cock - yes, like that","you're so good at taking $cock","I like how you take my cock"),
    $description is "take my cock" and _tags contains "breeder" and _race is not "black", (twirl:"take my $cock, it's gonna make you pregnant","take my $cock, yes, just like that - it's gonna erupt in your _race womb","take my $cock, I'm gonna breed your $pussy with it"),
    $description is "take my cock", (twirl:"that's right $your_sex_name, take my $cock","moan for this $cock bitch","take my $cock"),
    $description is "own this pussy" and _tags contains "chad" and _age > 35, (twirl:"that's right, show daddy who owns this pussy","we both know I own this $pussy now","this pussy is mine now","your $pussy won't ever forget my $cock","you won't be able to cum from any cock other than mine after this","show daddy who owns you now","daddy owns you now","show me who owns you now"),
    $description is "own this pussy" and (_tags contains "chad" or _tags contains "jock"), (twirl:"that's right, who owns this pussy $your_sex_name?","we both know I own this $pussy now","this pussy is mine now. It is my property.","your $pussy won't ever forget this $cock","you won't be able to cum from any cock other than mine after I'm through with you","show me who owns you now","I own you now, $your_sex_name","show me who owns you now"),
    $description is "own this pussy" and _tags contains "fuckboy", (twirl:"this $pussy was made for me. You love it","you know I own this $pussy now","your $pussy belongs to my $cock"),
    $description is "own this pussy" and _tags contains "nerd", (twirl:"squeeze my theorem, while I Poly your Nomial","I own this $pussy. Yeah! Can't wait to tell my friends","your $pussy is gonna crave my nerdy cock after this","how does it feel, having your $pussy belong to a nerd like me? Heh. So fucking good","your $pussy is mine. Way better than the ones in VR"),
    $description is "own this pussy" and (_tags contains "bully" or $npc's personality < 3), (twirl:"this $pussy was made for me. You love it","you know I own this $pussy now","your $pussy is mine","there's no going back now, I own this pussy","tell me who owns this pussy","I fucking own this $pussy now","this $pussy is mine now","your $pussy belongs to my $cock now"),
    $description is "own this pussy" and (_tags contains "gentleman" or $npc's personality > 7), (twirl:"your $pussy is mine","I own this $pussy","I fucking own this $pussy","my $cock owns this $pussy","I think your $pussy loves my $cock","your $pussy loves my $cock","your $pussy belongs to me now"),
    $description is "own this pussy" and _tags contains "breeder", (twirl:"your $pussy is gonna belong to me, after I flood it with my _cum","your $pussy belongs to me now. I'm gonna fucking breed it","your $pussy loves my $cock. I think it knows I'm gonna make you a single mother today"),
    $description is "own this pussy", (twirl:"this $pussy is mine","I own this $pussy","I fucking own this $pussy","my $cock owns this $pussy"),
    $description is "feels good" and _age > 39, (twirl:"I'll never age, if I got to fuck a $pussy like this for the rest of my life","your $pussy feels amazing on my _age-old cock","it feels amazing to fuck a young $girl like you","your $pussy feels amazing","your $pussy feels incredible"),
    $description is "feels good" and _age < 21, (twirl:"your $pussy feels amazing on my _age-old cock","your $pussy feels amazing","damn, your $pussy's tight, feels crazy good", "this $pussy hittin' different, feels too good", "I could stay buried in this $pussy all day, feels amazing"),
    $description is "feels good" and _tags contains "nerd",(twirl:"your $pussy feels even better than my fleshlight","your $pussy feels soo good","my friends were right, real pussy feels so much better than jerking off","your $pussy feels like what hentai looks like","your $pussy is AMAZING","your $pussy feels so good, the way it grips my $cock","your $pussy feels so nice") ,
    $description is "feels good" and (_tags contains "chad" or _tags contains "jock"), (twirl:"your $pussy feels good","your $pussy is wrapped SO fuckin' tight around my $cock","your $pussy loves having my $cock inside it","your $pussy feels damn good"),
    $description is "feels good", (twirl:"your $pussy feels so good","your $pussy feels so fucking good","so fucking good. Your $pussy is really gripping my $cock","your $pussy feels so good, the way it grips my $cock"),
    $description is "cum choice" and $his_choice is "creampie" and _tags contains "breeder", (twirl:"I wanna get you fucking pregnant","I wanna breed that tight $pussy","I'm gonna breed you $your_sex_name","I'm gonna fucking fill that $pussy to the brim with my _cum","we're gonna make little mixed babies","I'm gonna fill that fertile $pussy of yours with my _cum","I'm gonna make you a single mother"),
    $description is "cum choice" and $his_choice is "creampie" and _personality > 6, (twirl:"I wanna fill you with my _cum","I hope you like creampies","I wanna fill you up with _cum - hope you're ready","I'm gonna fucking fill you up","I wanna cum inside you","I wanna pump you full of my _cum","I'm gonna bust a nut inside you"),
    $description is "cum choice" and $his_choice is "creampie" and _tags contains "nerd", (twirl:"I wanna fill you with my _cum","I'm gonna bust a nut inside you","I'm gonna fucking fill you up","I wanna cum inside your $pussy","I wanna pump that $pussy full of my _cum") + " " + (twirl:"like you're one of my fleshlights","like they do in hentai","like they do in porn"),
    $description is "cum choice" and $his_choice is "creampie", (twirl:"I wanna fill your $pussy with my _cum","I'm gonna bust a fat nut inside you","I'm gonna fucking fill you up","I wanna cum inside you","I wanna pump you full of my _cum","I'm gonna bust a nut inside you"),
    $description is "cum choice" and $his_choice is "pull out", (twirl:"I can't wait to blow my load all over you","I wanna cover you with my _cum","I'm gonna bust a nut all over you","I'm gonna fucking hose you down with my _cum","I wanna glaze you with _cum, like a donut"),
    $description is "cum choice" and $his_choice is "face", (twirl:"I can't wait to blow my load all over that $face","I wanna paint your $face with my _cum","I'm gonna bust a nut all over your $face","I'm gonna fucking cover your $face with my _cum","I wanna cum on your $face","I wanna hose down your $face with my _cum","I can't wait to drain these balls all over your $face"),
    $description is "cum choice" and $his_choice is "mouth", (twirl:"I can't wait to watch you swallow my load","You're gonna be a _cum swallower today","I'm gonna cum in your mouth","I'm gonna fucking cum down your throat","I wanna cum in your mouth","I wanna bust a nut in your mouth","Hope you swallow, I'm pretty backed up"),
    (twirl:"that's right $your_sex_name, take my $cock","moan for daddy, $your_sex_name","take my $cock $your_sex_name")
    ))

    (set:$fuck to (twirl:"Fuck","Ngggh","Goddamn","Fucking hell","Holy fuck","Unnggh","Mnnngh","Fuck","Fuck","GodDAMN","Yeah","Fuck yeah","Hell yeah","Yes","That's right","Fuck yeah","Nggh- NGGH yes","FUCK yes","FUCK yeah"))
    (if:$npc's "generation" is "genz" and (twist:1,2) is 1)[(set:$fuck to (twirl:"Fuck","Ngggh","Goddamn","Fucking hell","Holy fuck","Unnggh","Mnnngh","Fuck","Fuck yeah","Shiiiit","Skrrt","Shit, fam","Sheesh","Sheeesh"))]
    
    (if:(twist:1,3) is 1)["(print:$fuck)(twirl:",","...","-")" (display:"npc pronoun") (twirl:"says","grunts","says","moans","says","grunts","groans","grunts")(if:(twist:1,2) is 1)[ (twirl:"as he pounds you","as he fucks you","as he rails you","as he fucks you")]. "(print:(upperfirst:$text))(if:(twist:1,2) is 1)[, $your_sex_name](twirl:"...","!",".")"]
    (else:)[(if:(twist:1,3) is 1)["(print:$fuck)(twirl:",","...","-") (print:$text)](else:)["(print:(upperfirst:$text))](if:(twist:1,2) is 1)[, $your_sex_name](if:(twist:1,2) is 1)[(twirl:"...","!",".")"](else:)[(twirl:"...","!",",")" (display:"npc pronoun") (twirl:"says","grunts","says")(if:(twist:1,2) is 1)[ (twirl:"as he pounds you","as he fucks you","as he rails you","as he fucks you")].]]
  ]
  (else:)[(display:_around)]
}
